<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>GymNest Admin Panel</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap + Icons + Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

    <!-- jQuery + ChartJS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root{
            --accent: #ff6a00;
            --accent-2: #ff8c2b;
            --black-900: #0c0f14;
            --black-800: #11151b;
            --black-700: #171b22;
            --white: #ffffff;
            --text-strong: #0f172a;
            --text: #1f2937;
            --muted: #6b7280;
            --border: #e5e7eb;
            --surface: #ffffff;
            --surface-2: #f7f8fb;
        }

        * { box-sizing: border-box; }

        /* Keep page flexible; don't lock height */
        html, body { height: auto; min-height: 100vh; }

        body {
            display: flex;
            flex-wrap: wrap;
            min-height: 100vh;
            font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
            color: var(--text);
            background: radial-gradient(1200px 600px at 10% -10%, #fff 0%, #fafbff 50%, #f5f6fb 100%);
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            height: 100dvh;
            position: fixed;
            top: 0; left: 0;
            background: linear-gradient(180deg, var(--black-900) 0%, var(--black-800) 60%, var(--black-700) 100%);
            color: var(--white);
            padding: 22px 18px;
            border-right: 1px solid rgba(255,255,255,0.06);
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-gutter: stable;
            padding-bottom: 16px;
        }
        @supports not (height: 100dvh) {
            .sidebar { height: 100vh; }
        }

        .sidebar h2 {
            font-weight: 700;
            letter-spacing: 0.3px;
            color: var(--white);
        }
        .sidebar h2::after{
            content:"";
            display:block;
            height:3px;
            width:60px;
            margin:10px auto 0;
            border-radius: 3px;
            background: linear-gradient(90deg, var(--accent), var(--accent-2));
        }

        .sidebar a {
            color: #d1d5db;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 14px;
            margin: 6px 6px;
            cursor: pointer;
            border-radius: 10px;
            transition: all .2s ease;
            position: relative;
            font-weight: 500;
        }
        .sidebar a i { width: 20px; text-align: center; }
        .sidebar a:hover {
            color: #f3f4f6;
            background: rgba(255,255,255,0.06);
            transform: translateX(2px);
        }
        .sidebar a.active {
            color: #ffffff;
            background: rgba(255, 106, 0, 0.15);
            box-shadow: inset 0 0 0 1px rgba(255,106,0,0.35);
        }
        .sidebar a.active::before {
            content:"";
            position: absolute;
            left: -6px; top: 8px; bottom: 8px;
            width: 4px;
            border-radius: 8px;
            background: linear-gradient(180deg, var(--accent), var(--accent-2));
            box-shadow: 0 0 12px rgba(255,106,0,0.6);
        }
        .sidebar .mt-auto {
            margin-top: auto;
            padding: 8px 10px 0;
            border-top: 1px solid rgba(255,255,255,0.06);
        }
        .sidebar .btn-danger {
            background: linear-gradient(180deg, #ff3b30, #d42a21);
            border: none;
            font-weight: 600;
            letter-spacing: .2px;
        }
        .sidebar .btn-danger:hover { filter: brightness(1.03); }

        /* Content */
        .content {
            flex-grow: 1;
            padding: 26px;
            margin-left: 260px;
            transition: margin-left 0.3s ease;
            width: calc(100% - 260px);
        }

        /* Cards */
        .card {
            border: 1px solid var(--border);
            border-radius: 16px;
            background: var(--surface);
            box-shadow: 0 6px 20px rgba(16, 24, 40, 0.06);
        }
        .card .card-icon i {
            background: linear-gradient(135deg, rgba(255,106,0,0.12), rgba(255,140,43,0.2));
            color: var(--accent);
            border-radius: 12px;
            width: 56px; height: 56px;
            display: grid;
            place-items: center;
            font-size: 1.4rem;
            box-shadow: 0 2px 10px rgba(255,106,0,0.15) inset;
        }
        h2, h5, h6 { color: var(--text-strong); }

        /* Buttons */
        .btn-primary {
            background: linear-gradient(180deg, var(--accent), var(--accent-2));
            border: none;
            font-weight: 600;
            letter-spacing: .2px;
            box-shadow: 0 8px 20px rgba(255,106,0,0.25);
        }
        .btn-primary:hover { filter: brightness(1.03); }
        .btn-outline-primary {
            color: var(--accent);
            border-color: var(--accent);
            font-weight: 600;
        }
        .btn-outline-primary:hover {
            background: var(--accent);
            color: #fff;
        }

        /* Forms */
        .form-control:focus, .form-select:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 .2rem rgba(255,106,0,.2);
        }

        /* Tables */
        .table {
            border-color: var(--border);
            background: var(--surface);
        }
        .table thead.table-dark th {
            background: var(--black-900) !important;
            color: #eef2ff !important;
            border-color: #1f2937 !important;
            position: relative;
        }
        .table thead.table-dark th:first-child::before {
            content:"";
            position:absolute;
            left:0; top:0; height:100%; width:4px;
            background: linear-gradient(180deg, var(--accent), var(--accent-2));
        }
        .table tbody tr:hover {
            background: #fff7f1;
        }

        /* Horizontal Scroll Row */
        .scroll-row {
            display: flex;
            gap: 16px;
            overflow-x: auto;
            padding-bottom: 12px;
            scrollbar-width: thin;
        }

        .scroll-row::-webkit-scrollbar {
            height: 8px;
        }

        .scroll-row::-webkit-scrollbar-thumb {
            background: rgba(0,0,0,0.2);
            border-radius: 6px;
        }

        /* Compact Stat Cards */
        .small-card {
            min-width: 200px;
            flex: 0 0 auto;
            padding: 16px;
            border-radius: 14px;
            background: linear-gradient(145deg, #fff, #f9fafc);
            box-shadow: 0 4px 14px rgba(16, 24, 40, 0.08);
            display: flex;
            align-items: center;
            gap: 14px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
        }

        .small-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(255, 106, 0, 0.2);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: grid;
            place-items: center;
            font-size: 1.5rem;
            background: linear-gradient(135deg, rgba(255,106,0,0.15), rgba(255,140,43,0.3));
            color: var(--accent, #ff6a00);
            box-shadow: inset 0 2px 6px rgba(255,106,0,0.15);
        }

        /* Different accent colors for sample cards */
        .sample1 {
            background: linear-gradient(135deg, rgba(0,123,255,0.15), rgba(0,123,255,0.35));
            color: #007bff;
        }

        .sample2 {
            background: linear-gradient(135deg, rgba(40,167,69,0.15), rgba(40,167,69,0.35));
            color: #28a745;
        }

        .stat-info h6 {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--muted, #6c757d);
            margin-bottom: 2px;
            text-transform: uppercase;
            letter-spacing: 0.4px;
        }

        .stat-info h2 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-strong, #222);
            margin: 0;
        }

        .chart-card {
            background: #fff;
            padding: 20px;
            border-radius: 14px;
            box-shadow: 0 4px 14px rgba(16, 24, 40, 0.08);
        }

        .chart-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: #333;
        }

        /* Badges override hint (kept Bootstrap colors for statuses) */
        .badge { font-weight: 600; }

        /* Charts wrappers */
        .chart-card {
            border-radius: 16px;
            overflow: hidden;
        }

        /* Utilities */
        .hidden { display: none; }

        /* Responsive */
        @media (max-width: 992px) {
            .sidebar { width: 100%; height: auto; position: relative; }
            .content { margin-left: 0; width: 100%; }
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 10px; height: 10px; }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--accent), var(--accent-2));
            border-radius: 10px;
        }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
    </style>
</head>
<body>
<!-- Sidebar -->
<div class="sidebar d-flex flex-column">
    <h2 class="text-center mb-3">GymNest Fitness Center</h2>

    <a class="active" onclick="showPanel('dashboard')"><i class="fas fa-gauge"></i> Dashboard</a>
    <a onclick="showPanel('members')"><i class="fas fa-users"></i> Members</a>
    <a onclick="showPanel('guides')"><i class="fas fa-user-tie"></i> Guides</a>
    <a onclick="showPanel('classes')"><i class="fas fa-dumbbell"></i> Classes</a>
    <a onclick="showPanel('locations')"><i class="fas fa-location-dot"></i> Locations</a>
    <a onclick="showPanel('memberships')"><i class="fas fa-id-card"></i> Memberships</a>
    <a onclick="showPanel('bookings')"><i class="fas fa-book"></i> Bookings</a>
    <a onclick="showPanel('payments')"><i class="fas fa-credit-card"></i> Payments</a>
    <a onclick="showPanel('reviews')"><i class="fas fa-star"></i> Reviews</a>
    <a onclick="showPanel('attendance')"><i class="fas fa-calendar-check"></i> Attendance</a>

    <div class="mt-auto">
        <h6 class="mb-2 text-white-50">Welcome back</h6>
        <h5 class="mb-3 text-white">Hi, <span id="adminName">admin</span></h5>
        <button class="btn btn-danger w-100" onclick="logout()">Log Out</button>
    </div>
</div>

<!-- Content -->
<div class="content">
    <!-- Dashboard -->
    <div class="container mt-2" id="dashboard">
        <h2 class="mb-4">Welcome to GymNest Dashboard</h2>

        <!-- Scrollable Row -->
        <div class="scroll-row">
            <!-- Sample Card: Revenue -->
            <div class="stat-card small-card">
                <div class="stat-icon sample1"><i class="fas fa-coins"></i></div>
                <div class="stat-info">
                    <h6>Revenue</h6>
                    <h2>$12K</h2>
                </div>
            </div>

            <!-- Sample Card: Feedback -->
            <div class="stat-card small-card">
                <div class="stat-icon sample2"><i class="fas fa-star"></i></div>
                <div class="stat-info">
                    <h6>Feedback</h6>
                    <h2>92%</h2>
                </div>
            </div>

            <!-- Total Members -->
            <div class="stat-card small-card">
                <div class="stat-icon"><i class="fas fa-users"></i></div>
                <div class="stat-info">
                    <h6>Total Members</h6>
                    <h2 id="totalMembers">0</h2>
                </div>
            </div>

            <!-- Active Memberships -->
            <div class="stat-card small-card">
                <div class="stat-icon"><i class="fas fa-bolt"></i></div>
                <div class="stat-info">
                    <h6>Active Memberships</h6>
                    <h2 id="activeMemberships">0</h2>
                </div>
            </div>

            <!-- Total Guides -->
            <div class="stat-card small-card">
                <div class="stat-icon"><i class="fas fa-user-tie"></i></div>
                <div class="stat-info">
                    <h6>Total Guides</h6>
                    <h2 id="totalGuides">0</h2>
                </div>
            </div>

            <!-- Per-Day Bookings -->
            <div class="stat-card small-card">
                <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
                <div class="stat-info">
                    <h6>Bookings Today</h6>
                    <h2 id="perDayBookings">0</h2>
                </div>
            </div>

            <!-- Total Classes -->
            <div class="stat-card small-card">
                <div class="stat-icon"><i class="fas fa-dumbbell"></i></div>
                <div class="stat-info">
                    <h6>Total Classes</h6>
                    <h2 id="totalClasses">0</h2>
                </div>
            </div>

            <!-- Total Locations -->
            <div class="stat-card small-card">
                <div class="stat-icon"><i class="fas fa-map-marker-alt"></i></div>
                <div class="stat-info">
                    <h6>Total Locations</h6>
                    <h2 id="totalLocations">0</h2>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts Section -->
    <div class="row mt-4">
        <!-- Membership Growth Chart -->
        <div class="col-md-6 mb-4">
            <div class="chart-card">
                <h6 class="chart-title">Membership Growth</h6>
                <canvas id="membershipChart"></canvas>
            </div>
        </div>

        <!-- Revenue Breakdown Chart -->
        <div class="col-md-6 mb-4">
            <div class="chart-card">
                <h6 class="chart-title">Revenue Breakdown</h6>
                <canvas id="revenueChart"></canvas>
            </div>
        </div>


    </div>

    <!-- Members -->
    <div id="members" class="hidden">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2>Member Management</h2>
            <div class="d-flex gap-2">
                <input type="text" id="searchMember" class="form-control" placeholder="Search by Name or Email" style="min-width: 260px;">
<!--                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMemberModal"><i class="fas fa-user-plus me-2"></i>Add Member</button>-->
            </div>
        </div>
        <div class="card p-3">
            <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                    <thead class="table-dark">
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Contact</th>
                        <th>Role</th>
                        <th style="width: 160px;">Actions</th>
                    </tr>
                    </thead>
                    <tbody id="memberTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Guides -->
    <div id="guides" class="hidden">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2>Guide Management</h2>
            <div class="d-flex gap-2">
                <input type="text" id="searchGuide" class="form-control" placeholder="Search Guides by Name or Email" style="min-width: 260px;">
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addGuideModal"><i class="fas fa-user-tie me-2"></i>Add Guide</button>
            </div>
        </div>
        <div class="card p-3">
            <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                    <thead class="table-dark">
                    <tr>
                        <th>Full Name</th>
                        <th>Email</th>
                        <th>Image</th>
                        <th>Description</th>
                        <th>Payment per hour</th>
                        <th>Phone</th>
                        <th>Status</th>
                        <th>Booked</th>
                        <th style="width: 180px;">Actions</th>
                    </tr>
                    </thead>
                    <tbody id="guideTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Classes -->
    <div id="classes" class="hidden">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2>Class Management</h2>
            <div class="d-flex gap-2">
                <input type="text" id="searchClass" class="form-control" placeholder="Search by Name or Guide" style="min-width: 260px;">
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addClassModal"><i class="fas fa-dumbbell me-2"></i>Add Class</button>
            </div>
        </div>
        <div class="card p-3">
            <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                    <thead class="table-dark">
                    <tr>
                        <th>Name</th>
                        <th>Guide</th>
                        <th>Day</th>
                        <th>Time</th>
                        <th>Capacity</th>
                        <th>Enrolled</th>
                        <th>Status</th>
                        <th style="width: 180px;">Actions</th>
                    </tr>
                    </thead>
                    <tbody id="classTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Locations -->
    <div id="locations" class="hidden">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2>Location Management</h2>
            <div class="d-flex gap-2">
                <input type="text" id="searchLocation" class="form-control" placeholder="Search by Name or Address" style="min-width: 260px;">
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addLocationModal"><i class="fas fa-map-marker-alt me-2"></i>Add Location</button>
            </div>
        </div>
        <div class="card p-3">
            <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                    <thead class="table-dark">
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Address</th>
                        <th>Open Hours</th>
                        <th>Image</th>
                        <th style="width: 180px;">Actions</th>
                    </tr>
                    </thead>
                    <tbody id="locationTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>


    <!-- Memberships -->
    <div id="memberships" class="hidden">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2>Membership Plans</h2>
            <div class="d-flex gap-2">
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMembershipModal"><i class="fas fa-id-card me-2"></i>Add Plan</button>
            </div>
        </div>
        <div class="card p-3">
            <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                    <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Price (LKR)</th>
                        <th>Image</th>
                        <th>Open Hours</th>
                        <th>Classes</th>
                        <th style="width: 180px;">Actions</th>
                    </tr>
                    </thead>
                    <tbody id="membershipTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Bookings -->
    <div id="bookings" class="hidden">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2>Booking Management</h2>
            <div class="d-flex gap-2">
                <input type="text" id="searchBooking" class="form-control" placeholder="Search by User Email" style="min-width: 260px;">
                <!--                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addBookingModal"><i class="fas fa-book me-2"></i>Add Booking</button>-->
            </div>
        </div>
        <div class="card p-3">
            <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                    <thead class="table-dark">
                    <tr>
                        <th>User Email</th>
                        <th>Package</th>
                        <th>Class</th>
                        <th>Coach</th>
                        <th>Location</th>
                        <th>Booking Date</th>
                        <th>End Date</th>
                        <th>Sessions</th>
                        <th>Package Price</th>
                        <th>Coach Fee</th>
                        <th>Total Price</th>
                        <th>Status</th>
                    </tr>
                    </thead>
                    <tbody id="bookingTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Payments -->
    <!-- Payments (updated) -->
    <div id="payments" class="hidden">
        <h2>Payment Management</h2>
        <div class="card p-3">
            <input type="text" id="searchPaymentEmail" class="form-control mb-3" placeholder="Search by member email...">
            <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                    <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Member Email</th>
                        <th>Amount (LKR)</th>
                        <th>Card Holder</th>
                        <th>Card Number</th>
                        <th>Expiry Date</th>
                        <th>CVV</th>
                        <th>Payment Date</th>
                    </tr>
                    </thead>
                    <tbody id="paymentTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!--reviews-->
    <div id="reviews" class="hidden">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2>Review Management</h2>
            <div class="d-flex gap-2">
                <input type="text" id="searchReview" class="form-control" placeholder="Search by User Email, Rating or Comment" style="min-width: 260px;">
                <!--                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addReviewModal"><i class="fas fa-star me-2"></i>Add Review</button>-->
            </div>
        </div>
        <div class="card p-3">
            <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                    <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>User Name</th>
                        <th>User Email</th>
                        <th>Rating</th>
                        <th>Comment</th>
                        <th>Created At</th>
                        <th style="width: 180px;">Actions</th>
                    </tr>
                    </thead>
                    <tbody id="reviewTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Attendance Section -->
    <div id="attendance" class="hidden">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2>Attendance</h2>
            <div class="d-flex gap-2">
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addAttendanceModal">
                    <i class="fas fa-calendar-plus me-2"></i>Mark Attendance
                </button>
            </div>
        </div>

<!--        &lt;!&ndash; Filter Section &ndash;&gt;-->
<!--        <div class="card p-3 mb-3">-->
<!--            <div class="row g-2">-->
<!--                <div class="col-md-4">-->
<!--                    <input type="date" id="attendanceDate" class="form-control" />-->
<!--                </div>-->
<!--                <div class="col-md-4">-->
<!--                    <input type="text" id="attendanceSearch" class="form-control" placeholder="Search by email or name"/>-->
<!--                </div>-->
<!--                <div class="col-md-4 d-grid">-->
<!--                    <button class="btn btn-outline-primary" onclick="loadAttendance()">Filter</button>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

        <!-- Attendance Table -->
        <div class="card p-3">
            <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                    <thead class="table-dark">
                    <tr>
                        <th>Date</th>
                        <th>Member</th>
                        <th>Email</th>
                        <th>Check-In</th>
                        <th>Check-Out</th>
                        <th>Status</th>
                    </tr>
                    </thead>
                    <tbody id="attendanceTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

<!-- Modals -->

<!--&lt;!&ndash; Add Member Modal &ndash;&gt;-->
<!--<div class="modal fade" id="addMemberModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="addMemberForm">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Add Member</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <div class="mb-3"><label class="form-label">Full Name</label><input type="text" class="form-control" id="memberName" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Email</label><input type="email" class="form-control" id="memberEmail" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Phone</label><input type="text" class="form-control" id="memberPhone" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Password</label><input type="password" class="form-control" id="memberPassword" required></div>-->
<!--                </div>-->
<!--                <div class="modal-footer"><button type="submit" class="btn btn-success">Create Member</button></div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!-- Add Guide Modal -->
<div class="modal fade" id="addGuideModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="addGuideForm" enctype="multipart/form-data">
                <div class="modal-header">
                    <h5 class="modal-title">Add Guide</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3"><label class="form-label">Full Name</label><input type="text" class="form-control" id="guideName" required></div>
                    <div class="mb-3"><label class="form-label">Email</label><input type="email" class="form-control" id="guideEmail" required></div>
                    <div class="mb-3"><label class="form-label">Phone</label><input type="text" class="form-control" id="guidePhone" required></div>
                    <div class="mb-3"><label class="form-label">Description</label><input type="text" class="form-control" id="guideDescription" required></div>
                    <div class="mb-3"><label class="form-label">Rate per Hour</label><input type="number" class="form-control" id="guidePaymentPerHour" required></div>
                    <div class="mb-3">
                        <label class="form-label">Image</label>
                        <input type="file" class="form-control" id="guideImage" accept="image/*">
                        <img id="guideImagePreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">
                    </div>
                </div>
                <div class="modal-footer"><button type="submit" class="btn btn-success">Save Guide</button></div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Guide Modal -->
<div class="modal fade" id="editGuideModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="editGuideForm" enctype="multipart/form-data">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Guide</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editGuideEmail">
                    <div class="mb-3"><label class="form-label">Full Name</label><input type="text" class="form-control" id="editGuideName"></div>
                    <div class="mb-3"><label class="form-label">Email</label><input type="email" class="form-control" id="editGuideEmailDisplay" disabled></div>
                    <div class="mb-3"><label class="form-label">Phone</label><input type="text" class="form-control" id="editGuidePhone"></div>
                    <div class="mb-3"><label class="form-label">Description</label><input type="text" class="form-control" id="editGuideDescription"></div>
                    <div class="mb-3"><label class="form-label">Rate per Hour</label><input type="number" class="form-control" id="editGuidePaymentPerHour"></div>
                    <div class="mb-3">
                        <label class="form-label">Image</label>
                        <input type="file" class="form-control" id="editGuideImage" accept="image/*">
                        <img id="editGuideImgPreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-success">Update Guide</button>
                    <button type="button" class="btn btn-outline-secondary" id="toggleStatusBtn" onclick="toggleGuideStatus()">Toggle Status</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Add Class Modal -->
<div class="modal fade" id="addClassModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="addClassForm">
                <div class="modal-header">
                    <h5 class="modal-title">Add Class</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3"><label class="form-label">Class Name</label><input type="text" class="form-control" id="className" required></div>
                    <div class="mb-3">
                        <label class="form-label">Guide</label>
                        <select id="classGuide" class="form-control" required></select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Day of Week</label>
                        <select id="classDay" class="form-control" required>
                            <option value="Monday">Monday</option>
                            <option value="Tuesday">Tuesday</option>
                            <option value="Wednesday">Wednesday</option>
                            <option value="Thursday">Thursday</option>
                            <option value="Friday">Friday</option>
                            <option value="Saturday">Saturday</option>
                            <option value="Sunday">Sunday</option>
                        </select>
                    </div>
                    <div class="mb-3"><label class="form-label">Start Time</label><input type="time" class="form-control" id="classStart" required></div>
                    <div class="mb-3"><label class="form-label">End Time</label><input type="time" class="form-control" id="classEnd" required></div>
                    <div class="mb-3"><label class="form-label">Capacity</label><input type="number" class="form-control" id="classCapacity" required></div>
                </div>
                <div class="modal-footer"><button type="submit" class="btn btn-success">Create Class</button></div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Class Modal -->
<div class="modal fade" id="editClassModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="editClassForm">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Class</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editClassId">
                    <div class="mb-3"><label class="form-label">Class Name</label><input type="text" class="form-control" id="editClassName" required></div>
                    <div class="mb-3">
                        <label class="form-label">Guide</label>
                        <select id="editClassGuide" class="form-control" required></select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Day of Week</label>
                        <select id="editClassDay" class="form-control" required>
                            <option value="Monday">Monday</option>
                            <option value="Tuesday">Tuesday</option>
                            <option value="Wednesday">Wednesday</option>
                            <option value="Thursday">Thursday</option>
                            <option value="Friday">Friday</option>
                            <option value="Saturday">Saturday</option>
                            <option value="Sunday">Sunday</option>
                        </select>
                    </div>
                    <div class="mb-3"><label class="form-label">Start Time</label><input type="time" class="form-control" id="editClassStart" required></div>
                    <div class="mb-3"><label class="form-label">End Time</label><input type="time" class="form-control" id="editClassEnd" required></div>
                    <div class="mb-3"><label class="form-label">Capacity</label><input type="number" class="form-control" id="editClassCapacity" required></div>
                </div>
                <div class="modal-footer"><button type="submit" class="btn btn-success">Update Class</button></div>
            </form>
        </div>
    </div>
</div>

<!-- Add Location Modal -->
<div class="modal fade" id="addLocationModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="addLocationForm" enctype="multipart/form-data">
                <div class="modal-header">
                    <h5 class="modal-title">Add Location</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Name</label>
                        <input type="text" class="form-control" id="locationName" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Description</label>
                        <input type="text" class="form-control" id="locationDescription" name="description" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Address</label>
                        <input type="text" class="form-control" id="locationAddress" name="address" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Open Hours</label>
                        <input type="text" class="form-control" id="locationOpenHours" name="openHours" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Image</label>
                        <input type="file" class="form-control" id="locationImage" name="imageUrl" accept="image/*">
                        <img id="locationImagePreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-success">Create Location</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Location Modal -->
<div class="modal fade" id="editLocationModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="editLocationForm" enctype="multipart/form-data">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Location</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editLocationId">
                    <div class="mb-3">
                        <label class="form-label">Name</label>
                        <input type="text" class="form-control" id="editLocationName" name="editLocationName" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Description</label>
                        <input type="text" class="form-control" id="editLocationDescription" name="editLocationDescription" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Address</label>
                        <input type="text" class="form-control" id="editLocationAddress" name="editLocationAddress" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Open Hours</label>
                        <input type="text" class="form-control" id="editLocationOpenHours" name="editLocationOpenHours" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Image</label>
                        <input type="file" class="form-control" id="editLocationImage" name="editLocationImage" accept="image/*">
                        <img id="editLocationImagePreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-success">Update Location</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Add Membership Modal -->
<div class="modal fade" id="addMembershipModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="addMembershipForm" enctype="multipart/form-data">
                <div class="modal-header">
                    <h5 class="modal-title">Add Membership Plan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3"><label class="form-label">Name</label><input type="text" class="form-control" id="membershipName" required></div>
                    <div class="mb-3"><label class="form-label">Description</label><input type="text" class="form-control" id="membershipDescription" required></div>
                    <div class="mb-3"><label class="form-label">Price (LKR)</label><input type="number" step="0.01" class="form-control" id="membershipPrice" required></div>
                    <div class="mb-3"><label class="form-label">Open Hours</label><input type="text" class="form-control" id="membershipOpenHours" required></div>
                    <div class="mb-3">
                        <label class="form-label">Classes</label>
                        <select id="membershipClassIds" class="form-control" multiple required></select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Image</label>
                        <input type="file" class="form-control" id="membershipImage" accept="image/*">
                        <img id="membershipImagePreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">
                    </div>
                </div>
                <div class="modal-footer"><button type="submit" class="btn btn-success">Create Plan</button></div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Membership Modal -->
<div class="modal fade" id="editMembershipModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="editMembershipForm" enctype="multipart/form-data">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Membership Plan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editMembershipId">
                    <div class="mb-3"><label class="form-label">Name</label><input type="text" class="form-control" id="editMembershipName" required></div>
                    <div class="mb-3"><label class="form-label">Description</label><input type="text" class="form-control" id="editMembershipDescription" required></div>
                    <div class="mb-3"><label class="form-label">Price (LKR)</label><input type="number" step="0.01" class="form-control" id="editMembershipPrice" required></div>
                    <div class="mb-3"><label class="form-label">Open Hours</label><input type="text" class="form-control" id="editMembershipOpenHours" required></div>
                    <div class="mb-3">
                        <label class="form-label">Classes</label>
                        <select id="editMembershipClassIds" class="form-control" multiple required></select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Image</label>
                        <input type="file" class="form-control" id="editMembershipImage" accept="image/*">
                        <img id="editMembershipImagePreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">
                    </div>
                </div>
                <div class="modal-footer"><button type="submit" class="btn btn-success">Update Plan</button></div>
            </form>
        </div>
    </div>
</div>

<!-- Add Booking Modal -->
<div class="modal fade" id="addBookingModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="addBookingForm">
                <div class="modal-header">
                    <h5 class="modal-title">Add Booking</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">User Email</label>
                        <input type="email" class="form-control" id="bookingUserEmail" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Package</label>
                        <select id="bookingPackage" class="form-control" required></select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Class</label>
                        <select id="bookingClass" class="form-control" required></select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Coach</label>
                        <select id="bookingCoach" class="form-control" required></select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Location</label>
                        <select id="bookingLocation" class="form-control" required></select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Booking Date</label>
                        <input type="date" class="form-control" id="bookingDate" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">End Date</label>
                        <input type="date" class="form-control" id="bookingEndDate" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Number of Sessions</label>
                        <input type="number" class="form-control" id="bookingSessions" required min="1">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Package Price</label>
                        <input type="number" step="0.01" class="form-control" id="bookingPackagePrice" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Coach Fee</label>
                        <input type="number" step="0.01" class="form-control" id="bookingCoachFee" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Total Price</label>
                        <input type="number" step="0.01" class="form-control" id="bookingTotalPrice" readonly>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Status</label>
                        <select id="bookingStatus" class="form-control" required>
                            <option value="ACTIVE">Active</option>
                            <option value="COMPLETED">Completed</option>
                            <option value="CANCELLED">Cancelled</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-success">Create Booking</button>
                </div>
            </form>
        </div>
    </div>
</div>


    <!-- Add Attendance Modal -->
    <div class="modal fade" id="addAttendanceModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <form id="addAttendanceForm">
                    <div class="modal-header">
                        <h5 class="modal-title">Mark Attendance</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">Member Email</label>
                            <input type="email" class="form-control" id="attendanceEmail" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Date</label>
                            <input type="date" class="form-control" id="attendanceMarkDate" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Check-In Time</label>
                            <input type="time" class="form-control" id="attendanceCheckIn" value="">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Check-Out Time</label>
                            <input type="time" class="form-control" id="attendanceCheckOut" value="">
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-success">Mark Attendance</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Scripts -->
<script>
    let membershipChartInstance = null;
    let revenueChartInstance = null;

    // Chart.js defaults
    Chart.defaults.font.family = "Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
    Chart.defaults.color = "#6b7280";

    // Auth headers
    function authHeaders() {
        const token = localStorage.getItem("token");
        return token ? { "Authorization": "Bearer " + token } : {};
    }

        function showPanel(panelId) {
        $('.sidebar a').removeClass('active');
        $('.sidebar a').filter(function(){ return $(this).attr('onclick')?.includes(panelId); }).addClass('active');

        $('.content > div').addClass('hidden');
        $('#' + panelId).removeClass('hidden');

        switch (panelId) {
            // case 'dashboard': loadDashboardCounts(); break; // Removed loadSignupsChart
            case 'dashboard':
                loadDashboardCounts();
                loadMembershipGrowthChart();
                loadRevenueBreakdownChart();
                break;
            case 'members': loadAllUsers(); break;
            case 'guides': loadAllGuides(); break;
            case 'classes': loadGuideOptions(); loadAllClasses(); break;
            case 'locations': loadAllLocations(); loadAllLocations(); break;
            case 'memberships': loadAllClassesForPackages(); loadAllPackages(); break;
            case 'bookings': loadAllBookings(); loadBookingOptions(); break;
            case 'payments': loadAllPayments(); break;
            case 'reviews': loadAllReviews(); break;
            case 'attendance': loadAttendance(); break;
        }
    }
    // Logout
    function logout() {
        localStorage.removeItem("name");
        localStorage.removeItem("token");
        localStorage.removeItem("email");
        localStorage.removeItem("role");
        window.location.href = "index.html";
    }

    // On Ready
    $(document).ready(function(){
        const adminStoredName = localStorage.getItem("name");
        if (adminStoredName) $("#adminName").text(adminStoredName);

        showPanel('dashboard');

        // Image previews
        $("#guideImage").on("change", function(){
            const file = this.files[0];
            if (!file) return;
            $("#guideImagePreview").attr("src", URL.createObjectURL(file)).show();
        });
        $("#editGuideImage").on("change", function(){
            const file = this.files[0];
            if (!file) return;
            $("#editGuideImgPreview").attr("src", URL.createObjectURL(file)).show();
        });
        $("#membershipImage").on("change", function(){
            const file = this.files[0];
            if (!file) return;
            $("#membershipImagePreview").attr("src", URL.createObjectURL(file)).show();
        });
        $("#editMembershipImage").on("change", function(){
            const file = this.files[0];
            if (!file) return;
            $("#editMembershipImagePreview").attr("src", URL.createObjectURL(file)).show();
        });

        // Live searches
        $("#searchMember").on("input", function(){
            const q = $(this).val().toLowerCase();
            const filtered = (window.allUsers || []).filter(m => (m.name||"").toLowerCase().includes(q) || (m.email||"").toLowerCase().includes(q));
            renderUsers(filtered);
        });
        $("#searchGuide").on("input", function(){
            const q = $(this).val().toLowerCase();
            const filtered = (window.allGuides || []).filter(g => (g.fullName||"").toLowerCase().includes(q) || (g.email||"").toLowerCase().includes(q));
            renderGuides(filtered);
        });
        $("#searchClass").on("input", function(){
            const q = $(this).val().toLowerCase();
            const filtered = (window.allClasses || []).filter(c => (c.name||"").toLowerCase().includes(q) || (c.guideName||"").toLowerCase().includes(q));
            renderClasses(filtered);
        });
        $("#searchBooking").on("input", function(){
            const q = $(this).val().toLowerCase();
            const filtered = (window.allBookings || []).filter(b => (b.userEmail||"").toLowerCase().includes(q));
            renderBookings(filtered);
        });
        $("#searchPaymentEmail").on("input", function () {
            const q = $(this).val().toLowerCase();
            const filtered = (window.allPayments || []).filter(p => (p.userEmail || "").toLowerCase().includes(q));
            renderPayments(filtered);
        });

        // Forms submit
        $("#addMemberForm").on("submit", createUser);
        $("#addGuideForm").on("submit", createGuide);
        $("#editGuideForm").on("submit", updateGuide);
        $("#addClassForm").on("submit", createClass);
        $("#editClassForm").on("submit", updateClass);
        $("#addMembershipForm").on("submit", createPackage);
        $("#editMembershipForm").on("submit", updatePackage);
        $("#addBookingForm").on("submit", createBooking);
        $("#addAttendanceForm").on("submit", markAttendance);

        // Calculate total price for booking
        $("#bookingPackagePrice, #bookingCoachFee").on("input", function() {
            const packagePrice = parseFloat($("#bookingPackagePrice").val()) || 0;
            const coachFee = parseFloat($("#bookingCoachFee").val()) || 0;
            $("#bookingTotalPrice").val((packagePrice + coachFee).toFixed(2));
        });
    });

    // DASHBOARD
    function loadDashboardCounts() {
        $.ajax({
            url: "http://localhost:8080/api/v1/dashboard/counts",
            method: "GET",
            headers: authHeaders(),
            success: function (res) {
                $("#totalMembers").text(res.data?.totalMembers || 0);
                $("#activeMemberships").text(res.data?.activeMemberships || 0);
                $("#totalGuides").text(res.data?.totalGuides || 0);
                $("#perDayBookings").text(res.data?.perDayBookings || 0);
                $("#totalClasses").text(res.data?.totalClasses || 0);
                $("#totalLocations").text(res.data?.totalLocations || 0);
            },
            error: function () {
                console.warn("Failed to load dashboard counts.");
            }
        });
    }


    function loadMembershipGrowthChart() {
        $.ajax({
            url: "http://localhost:8080/api/v1/dashboard/membership-growth",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                const ctx = document.getElementById('membershipChart').getContext('2d');

                if (membershipChartInstance) {
                    membershipChartInstance.destroy();
                }

                membershipChartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: res.data?.labels || ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                        datasets: [{
                            label: 'New Members',
                            data: res.data?.values || [30, 45, 60, 80, 95, 120],
                            borderColor: '#ff6a00',
                            backgroundColor: 'rgba(255, 106, 0, 0.2)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { display: false } }
                    }
                });
            },
            error: function(xhr) {
                console.error("Failed to load membership growth data:", xhr);
                // Fallback static chart
                const ctx = document.getElementById('membershipChart').getContext('2d');
                if (membershipChartInstance) membershipChartInstance.destroy();

                membershipChartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                        datasets: [{
                            label: 'New Members',
                            data: [30, 45, 60, 80, 95, 120],
                            borderColor: '#ff6a00',
                            backgroundColor: 'rgba(255, 106, 0, 0.2)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { display: false } }
                    }
                });
            }
        });
    }

    function loadRevenueBreakdownChart() {
        $.ajax({
            url: "http://localhost:8080/api/v1/dashboard/revenue-breakdown",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                const ctx = document.getElementById('revenueChart').getContext('2d');

                if (revenueChartInstance) {
                    revenueChartInstance.destroy();
                }

                revenueChartInstance = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: res.data?.labels || ['Memberships', 'Classes', 'Personal Training'],
                        datasets: [{
                            data: res.data?.values || [65, 25, 10],
                            backgroundColor: ['#ff6a00', '#007bff', '#28a745'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { font: { size: 12 } }
                            }
                        }
                    }
                });
            },
            error: function(xhr) {
                console.error("Failed to load revenue breakdown data:", xhr);
                // Fallback static chart
                const ctx = document.getElementById('revenueChart').getContext('2d');
                if (revenueChartInstance) revenueChartInstance.destroy();

                revenueChartInstance = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Memberships', 'Classes', 'Personal Training'],
                        datasets: [{
                            data: [65, 25, 10],
                            backgroundColor: ['#ff6a00', '#007bff', '#28a745'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { font: { size: 12 } }
                            }
                        }
                    }
                });
            }
        });
    }

    // Instead of charts, add Booking Summary Table
    function loadBookingSummary() {
        $.ajax({
            url: "http://localhost:8080/api/v1/bookings/summary/today",
            method: "GET",
            headers: authHeaders(),
            success: function (res) {
                const tbody = $("#bookingSummaryTable tbody");
                tbody.empty();
                (res.data || []).forEach(b => {
                    tbody.append(`
                    <tr>
                        <td>${b.memberName}</td>
                        <td>${b.className}</td>
                        <td>${b.time}</td>
                        <td>${b.status}</td>
                    </tr>
                `);
                });
            },
            error: function () {
                console.warn("Failed to load booking summary.");
            }
        });
    }


    // MEMBERS (Users)
    function loadAllUsers() {
        $.ajax({
            url: "http://localhost:8080/api/v1/user/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function (res) {
                window.allUsers = res.data || [];
                renderUsers(window.allUsers);
            },
            error: function () { alert("Failed to load users."); }
        });
    }

    function renderUsers(users) {
        const tbody = $("#memberTableBody");
        tbody.empty();
        users.forEach(u => {
            tbody.append(`
        <tr>
          <td>${u.name || "-"}</td>
          <td>${u.email || "-"}</td>
          <td>${u.contact || "-"}</td>
          <td><span class="badge bg-${u.role === 'USER' ? 'success' : 'secondary'}">${u.role || "-"}</span></td>
          <td>
            <button class="btn btn-sm btn-danger" onclick="deleteUser('${u.email}')">Delete</button>
          </td>
        </tr>
      `);
        });
    }

    function createUser(e) {
        e.preventDefault();
        const payload = {
            name: $("#memberName").val(),
            email: $("#memberEmail").val(),
            contact: $("#memberPhone").val(),
            password: $("#memberPassword").val(),
            role: "USER"
        };
        $.ajax({
            url: "http://localhost:8080/api/v1/user/register",
            method: "POST",
            headers: { "Content-Type": "application/json", ...authHeaders() },
            data: JSON.stringify(payload),
            success: function (res) {
                if (res.code === 201) {
                    $("#addMemberModal").modal("hide");
                    $("#addMemberForm")[0].reset();
                    loadAllUsers();
                    alert("User created successfully!");
                } else if (res.code === 406) {
                    alert("Email already used. Please use a different email.");
                } else {
                    alert("Failed to create user: " + (res.message || "Unknown error"));
                }
            },
            error: function (xhr) {
                alert("Failed to create user: " + (xhr.responseJSON?.message || "Server error"));
            }
        });
    }

    function deleteUser(email) {
        if (!confirm("Delete this user?")) return;
        $.ajax({
            url: `http://localhost:8080/api/v1/user/delete/${email}`,
            method: "DELETE",
            headers: authHeaders(),
            success: function () { loadAllUsers(); },
            error: function () { alert("Failed to delete user."); }
        });
    }

    // GUIDES
    function loadAllGuides() {
        $.ajax({
            url: "http://localhost:8080/api/v1/guide/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function (res) {
                window.allGuides = res.data || [];
                renderGuides(window.allGuides);
            },
            error: function(){ alert("Failed to load guides."); }
        });
    }

    function renderGuides(guides) {
        const tbody = $("#guideTableBody");
        tbody.empty();
        guides.forEach(g => {
            const img = g.imageUrl ? `<img src="/Uploads/${g.imageUrl}" style="width:60px;height:60px;border-radius:10px;object-fit:cover; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">` : "-";
            tbody.append(`
        <tr>
          <td>${g.fullName || "-"}</td>
          <td>${g.email || "-"}</td>
          <td>${img}</td>
          <td>${g.description || "-"}</td>
          <td>LKR ${Number(g.paymentPerHour || 0).toFixed(2)}</td>
          <td>${g.phone || "-"}</td>
          <td><span class="badge bg-${g.status === 'ACTIVE' ? 'success' : 'secondary'}">${g.status || "-"}</span></td>
          <td><span class="badge bg-${g.booked === 'NO' ? 'success' : 'warning'}">${g.booked || "-"}</span></td>
          <td>
            <button class="btn btn-sm btn-outline-secondary me-1" onclick='openEditGuide(${JSON.stringify(g).replace(/'/g,"&#39;")})'>Edit</button>
            <button class="btn btn-sm btn-danger" onclick="deleteGuide('${g.email}')">Delete</button>
          </td>
        </tr>
      `);
        });
    }


    function openEditGuide(guide) {
        $("#editGuideEmail").val(guide.email);
        $("#editGuideName").val(guide.fullName || "");
        $("#editGuideEmailDisplay").val(guide.email || "");
        $("#editGuidePhone").val(guide.phone || "");
        $("#editGuideDescription").val(guide.description || "");
        $("#editGuidePaymentPerHour").val(guide.paymentPerHour || "");
        $("#toggleStatusBtn").text(guide.status === "ACTIVE" ? "Deactivate" : "Activate");

        if (guide.imageUrl) {
            $("#editGuideImgPreview").attr("src", `/Uploads/${guide.imageUrl}`).show();
        } else {
            $("#editGuideImgPreview").hide();
        }

        const modal = new bootstrap.Modal(document.getElementById('editGuideModal'));
        modal.show();
    }


    function createGuide(e) {
        e.preventDefault();
        const fd = new FormData();
        fd.append("fullName", $("#guideName").val());
        fd.append("email", $("#guideEmail").val());
        fd.append("phone", $("#guidePhone").val());
        fd.append("description", $("#guideDescription").val());
        fd.append("paymentPerHour", $("#guidePaymentPerHour").val());
        if ($("#guideImage")[0].files[0]) fd.append("imageUrl", $("#guideImage")[0].files[0]);

        $.ajax({
            url: "http://localhost:8080/api/v1/guide/save",
            method: "POST",
            headers: authHeaders(),
            processData: false,
            contentType: false,
            data: fd,
            success: function(res) {
                if (res.status === "Created") {
                    $("#addGuideModal").modal("hide");
                    $("#addGuideForm")[0].reset();
                    $("#guideImagePreview").hide();
                    loadAllGuides();
                    alert("Guide saved successfully!");
                } else {
                    alert("Failed to save guide: " + (res.message || "Unknown error"));
                }
            },
            error: function(xhr) {
                alert("Failed to create guide: " + (xhr.responseJSON?.message || "Server error"));
            }
        });
    }

    function updateGuide(e) {
        e.preventDefault();
        const email = $("#editGuideEmail").val();
        const fd = new FormData();
        fd.append("editGuideName", $("#editGuideName").val());
        fd.append("editGuidePhone", $("#editGuidePhone").val());
        fd.append("editGuideDescription", $("#editGuideDescription").val());
        fd.append("editGuidePayment", $("#editGuidePaymentPerHour").val());
        if ($("#editGuideImage")[0].files[0]) fd.append("editGuideImage", $("#editGuideImage")[0].files[0]);

        $.ajax({
            url: `http://localhost:8080/api/v1/guide/update/${email}`,
            method: "POST",
            headers: authHeaders(),
            processData: false,
            contentType: false,
            data: fd,
            success: function() {
                $("#editGuideModal").modal("hide");
                loadAllGuides();
            },
            error: function() { alert("Failed to update guide."); }
        });
    }

    function toggleGuideStatus() {
        const email = $("#editGuideEmail").val();
        const currentStatus = $("#toggleStatusBtn").text() === "Deactivate" ? "ACTIVE" : "INACTIVE";
        const endpoint = currentStatus === "ACTIVE" ? "deactivate" : "activate";
        $.ajax({
            url: `http://localhost:8080/api/v1/guide/${endpoint}/${email}`,
            method: "PUT",
            headers: authHeaders(),
            success: function() {
                $("#editGuideModal").modal("hide");
                loadAllGuides();
            },
            error: function() { alert(`Failed to ${endpoint} guide.`); }
        });
    }

    function deleteGuide(email) {
        if (!confirm("Delete this guide?")) return;
        $.ajax({
            url: `http://localhost:8080/api/v1/guide/delete/${email}`,
            method: "DELETE",
            headers: authHeaders(),
            success: function() { loadAllGuides(); },
            error: function() { alert("Failed to delete guide."); }
        });
    }

    // CLASSES
    function loadGuideOptions() {
        const guides = window.allGuides || [];
        const sel = $("#classGuide");
        const editSel = $("#editClassGuide");
        sel.empty();
        editSel.empty();
        guides.forEach(g => {
            sel.append(`<option value="${g.email}">${g.fullName}</option>`);
            editSel.append(`<option value="${g.email}">${g.fullName}</option>`);
        });
    }

    function loadAllClasses() {
        $.ajax({
            url: "http://localhost:8080/api/v1/class/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                window.allClasses = res.data || [];
                console.log("Loaded classes:", window.allClasses);
                renderClasses(window.allClasses);
            },
            error: function() { alert("Failed to load classes."); }
        });
    }

    function loadAllClassesForPackages() {
        $.ajax({
            url: "http://localhost:8080/api/v1/class/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                window.allClassesForPackages = res.data || [];
                const sel = $("#membershipClassIds");
                const editSel = $("#editMembershipClassIds");
                sel.empty();
                editSel.empty();
                window.allClassesForPackages.forEach(c => {
                    sel.append(`<option value="${c.name}">${c.name}</option>`);
                    editSel.append(`<option value="${c.name}">${c.name}</option>`);
                });
            }
        });
    }

    function renderClasses(classes) {
        const tbody = $("#classTableBody");
        tbody.empty();
        classes.forEach(c => {
            tbody.append(`
        <tr>
          <td>${c.name || "-"}</td>
          <td>${c.trainer || "-"}</td>
          <td>${c.day || "-"}</td>
          <td>${c.time || "-"}</td>
          <td>${c.capacity || 0}</td>
          <td>${c.enrolled || 0}</td>
          <td><span class="badge bg-${c.status === 'AVAILABLE' ? 'success' : 'secondary'}">${c.status || "-"}</span></td>
          <td>
            <button class="btn btn-sm btn-outline-secondary me-1" onclick='openEditClass(${JSON.stringify(c).replace(/'/g,"&#39;")})'>Update</button>
            <button class="btn btn-sm btn-danger" onclick="deleteClass('${c.id}')">Delete</button>
          </td>
        </tr>
      `);
        });
    }

    function openEditClass(classData) {
        $("#editClassId").val(classData.id);
        $("#editClassName").val(classData.name || "");
        $("#editClassGuide").val(classData.guideId || "");
        $("#editClassDay").val(classData.day || "");
        const [start, end] = (classData.time || "").split(" - ");
        $("#editClassStart").val(start || "");
        $("#editClassEnd").val(end || "");
        $("#editClassCapacity").val(classData.capacity || "");
        const modal = new bootstrap.Modal(document.getElementById('editClassModal'));
        modal.show();
    }

    function createClass(e) {
        e.preventDefault();
        const startTime = $("#classStart").val();
        const endTime = $("#classEnd").val();
        const time = `${startTime} - ${endTime}`;
        const guideName = $("#classGuide option:selected").text();

        const formData = new FormData();
        formData.append("name", $("#className").val());
        formData.append("trainer", guideName);
        formData.append("day", $("#classDay").val());
        formData.append("time", time);
        formData.append("capacity", parseInt($("#classCapacity").val()));

        $.ajax({
            url: "http://localhost:8080/api/v1/class/save",
            method: "POST",
            headers: authHeaders(),
            processData: false,
            contentType: false,
            data: formData,
            success: function(res) {
                if (res.code === 201) {
                    $("#addClassModal").modal("hide");
                    $("#addClassForm")[0].reset();
                    loadAllClasses();
                    alert("Class created successfully!");
                } else {
                    alert("Failed to create class: " + (res.message || "Unknown error"));
                }
            },
            error: function(xhr) {
                console.error("API Error:", xhr.responseText);
                alert("Failed to create class: " + (xhr.responseJSON?.message || "Server error. Check console for details."));
            }
        });
    }

    function updateClass(e) {
        e.preventDefault();
        const id = $("#editClassId").val();
        const startTime = $("#editClassStart").val();
        const endTime = $("#editClassEnd").val();
        const time = `${startTime} - ${endTime}`;
        const guideName = $("#editClassGuide option:selected").text();

        const formData = new FormData();
        formData.append("editName", $("#editClassName").val());
        formData.append("editTrainer", guideName);
        formData.append("editDay", $("#editClassDay").val());
        formData.append("editTime", time);
        formData.append("editCapacity", parseInt($("#editClassCapacity").val()));

        $.ajax({
            url: `http://localhost:8080/api/v1/class/update/${id}`,
            method: "PUT",
            headers: authHeaders(),
            processData: false,
            contentType: false,
            data: formData,
            success: function(res) {
                if (res.code === 201) {
                    $("#editClassModal").modal("hide");
                    loadAllClasses();
                    alert("Class updated successfully!");
                } else {
                    alert("Failed to update class: " + (res.message || "Unknown error"));
                }
            },
            error: function(xhr) {
                console.error("API Error:", xhr.responseText);
                alert("Failed to update class: " + (xhr.responseJSON?.message || "Server error. Check console for details."));
            }
        });
    }

    function deleteClass(id) {
        if (!confirm("Delete this class?")) return;
        $.ajax({
            url: `http://localhost:8080/api/v1/class/delete/${id}`,
            method: "DELETE",
            headers: authHeaders(),
            success: function() { loadAllClasses(); },
            error: function() { alert("Failed to delete class."); }
        });
    }

    // Image preview for add location
    $("#locationImage").on("change", function() {
        const file = this.files[0];
        if (file) {
            $("#locationImagePreview").attr("src", URL.createObjectURL(file)).show();
        } else {
            $("#locationImagePreview").hide();
        }
    });

    // Image preview for edit location
    $("#editLocationImage").on("change", function() {
        const file = this.files[0];
        if (file) {
            $("#editLocationImagePreview").attr("src", URL.createObjectURL(file)).show();
        } else {
            $("#editLocationImagePreview").hide();
        }
    });

    // Live search for locations
    $("#searchLocation").on("input", function() {
        const q = $(this).val().toLowerCase();
        const filtered = (window.allLocations || []).filter(l =>
            (l.name || "").toLowerCase().includes(q) ||
            (l.address || "").toLowerCase().includes(q)
        );
        renderLocations(filtered);
    });

    // Load all locations
    function loadAllLocations() {
        $.ajax({
            url: "http://localhost:8080/api/v1/location/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                window.allLocations = res.data || [];
                renderLocations(window.allLocations);
            },
            error: function(xhr) {
                alert("Failed to load locations: " + (xhr.responseJSON?.message || "Server error"));
            }
        });
    }

    function renderLocations(locations) {
        const tbody = $("#locationTableBody");
        tbody.empty();
        locations.forEach(l => {
            const img = l.imageUrl
                ? `<img src="http://localhost:8080/uploads/${l.imageUrl}"
                style="width:60px;height:60px;border-radius:10px;object-fit:cover;box-shadow:0 2px 8px rgba(0,0,0,0.1);"
                onerror="this.style.display='none';">`
                : "-";
            tbody.append(`
            <tr>
                <td>${l.name || "-"}</td>
                <td>${l.description || "-"}</td>
                <td>${l.address || "-"}</td>
                <td>${l.openHours || "-"}</td>
                <td>${img}</td>
                <td>
                    <button class="btn btn-sm btn-outline-secondary me-1" onclick='openEditLocation(${JSON.stringify(l).replace(/'/g, "\\'")})'>Edit</button>
                    <button class="btn btn-sm btn-danger" onclick="deleteLocation(${l.id})">Delete</button>
                </td>
            </tr>
        `);
        });
    }

    // Open edit location modal
    function openEditLocation(location) {
        $("#editLocationId").val(location.id || "");
        $("#editLocationName").val(location.name || "");
        $("#editLocationDescription").val(location.description || "");
        $("#editLocationAddress").val(location.address || "");
        $("#editLocationOpenHours").val(location.openHours || "");
        if (location.imageUrl) {
            $("#editLocationImagePreview").attr("src", `http://localhost:8080/uploads/${location.imageUrl}`).show();
        } else {
            $("#editLocationImagePreview").hide();
        }
        new bootstrap.Modal(document.getElementById('editLocationModal')).show();
    }

    // Create location
    function createLocation(e) {
        e.preventDefault();
        const fd = new FormData();
        fd.append("name", $("#locationName").val());
        fd.append("description", $("#locationDescription").val());
        fd.append("address", $("#locationAddress").val());
        fd.append("openHours", $("#locationOpenHours").val());
        if ($("#locationImage")[0].files[0]) {
            fd.append("imageUrl", $("#locationImage")[0].files[0]);
        }
        $.ajax({
            url: "http://localhost:8080/api/v1/location/save",
            method: "POST",
            headers: authHeaders(),
            processData: false,
            contentType: false,
            data: fd,
            success: function(res) {
                if (res.code === 201) {
                    $("#addLocationModal").modal("hide");
                    $("#addLocationForm")[0].reset();
                    $("#locationImagePreview").hide();
                    loadAllLocations();
                    alert("Location created successfully!");
                } else {
                    alert(res.message || "Failed to create location");
                }
            },
            error: function(xhr) {
                alert("Failed to create location: " + (xhr.responseJSON?.message || "Server error"));
            }
        });
    }

    // Update location
    function updateLocation(e) {
        e.preventDefault();
        const id = $("#editLocationId").val();
        const fd = new FormData();
        fd.append("editLocationName", $("#editLocationName").val());
        fd.append("editLocationDescription", $("#editLocationDescription").val());
        fd.append("editLocationAddress", $("#editLocationAddress").val());
        fd.append("editLocationOpenHours", $("#editLocationOpenHours").val());
        if ($("#editLocationImage")[0].files[0]) {
            fd.append("editLocationImage", $("#editLocationImage")[0].files[0]);
        }
        $.ajax({
            url: `http://localhost:8080/api/v1/location/update/${id}`,
            method: "POST",
            headers: authHeaders(),
            processData: false,
            contentType: false,
            data: fd,
            success: function(res) {
                if (res.code === 201) {
                    $("#editLocationModal").modal("hide");
                    loadAllLocations();
                    alert("Location updated successfully!");
                } else {
                    alert(res.message || "Failed to update location");
                }
            },
            error: function(xhr) {
                alert("Failed to update location: " + (xhr.responseJSON?.message || "Server error"));
            }
        });
    }

    // Delete location
    function deleteLocation(id) {
        if (!confirm("Are you sure you want to delete this location?")) return;
        $.ajax({
            url: `http://localhost:8080/api/v1/location/delete/${id}`,
            method: "DELETE",
            headers: authHeaders(),
            success: function(res) {
                if (res.code === 201) {
                    loadAllLocations();
                    alert("Location deleted successfully!");
                } else {
                    alert(res.message || "Failed to delete location");
                }
            },
            error: function(xhr) {
                alert("Failed to delete location: " + (xhr.responseJSON?.message || "Server error"));
            }
        });
    }

    // Document ready
    $(document).ready(function() {
        $("#addLocationForm").on("submit", createLocation);
        $("#editLocationForm").on("submit", updateLocation);
        $('.sidebar a').filter(function() {
            return $(this).attr('onclick')?.includes('locations');
        }).on('click', function() {
            showPanel('locations');
            loadAllLocations();
        });
    });



    // MEMBERSHIPS (Packages)
    function loadAllPackages() {
        $.ajax({
            url: "http://localhost:8080/api/v1/package/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function (res) {
                window.allPackages = res.data || [];
                renderPackages(window.allPackages);
            },
            error: function() { alert("Failed to load packages."); }
        });
    }

    function renderPackages(packages) {
        const tbody = $("#membershipTableBody");
        tbody.empty();
        packages.forEach(p => {
            const classes = p.classes ? p.classes.join(", ") : "-";
            const img = p.imageUrl ? `<img src="/Uploads/${p.imageUrl}" style="width:60px;height:60px;border-radius:10px;object-fit:cover; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">` : "-";
            tbody.append(`
                <tr>
                    <td>${p.id || "-"}</td>
                    <td>${p.name || "-"}</td>
                    <td>${p.description || "-"}</td>
                    <td>LKR ${Number(p.price || 0).toFixed(2)}</td>
                    <td>${img}</td>
                    <td>${p.openHours || "-"}</td>
                    <td>${classes}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-secondary me-1" onclick='openEditPackage(${JSON.stringify(p).replace(/'/g,"&#39;")})'>Edit</button>
                        <button class="btn btn-sm btn-danger" onclick="deletePackage(${p.id})">Delete</button>
                    </td>
                </tr>
            `);
        });
    }

    function loadAllClassesForPackages() {
        $.ajax({
            url: "http://localhost:8080/api/v1/class/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                window.allClassesForPackages = res.data || [];
                const sel = $("#membershipClassIds");
                const editSel = $("#editMembershipClassIds");
                sel.empty();
                editSel.empty();
                window.allClassesForPackages.forEach(c => {
                    sel.append(`<option value="${c.name}">${c.name}</option>`);
                    editSel.append(`<option value="${c.name}">${c.name}</option>`);
                });
            }
        });
    }

    function openEditPackage(packageData) {
        $("#editMembershipId").val(packageData.id);
        $("#editMembershipName").val(packageData.name || "");
        $("#editMembershipDescription").val(packageData.description || "");
        $("#editMembershipPrice").val(packageData.price || "");
        $("#editMembershipOpenHours").val(packageData.openHours || "");
        const sel = $("#editMembershipClassIds");
        sel.val(packageData.classes || []);
        if (packageData.imageUrl) {
            $("#editMembershipImagePreview").attr("src", `/Uploads/${packageData.imageUrl}`).show();
        } else {
            $("#editMembershipImagePreview").hide();
        }
        const modal = new bootstrap.Modal(document.getElementById('editMembershipModal'));
        modal.show();
    }

    function createPackage(e) {
        e.preventDefault();
        const fd = new FormData();
        fd.append("name", $("#membershipName").val());
        fd.append("description", $("#membershipDescription").val());
        fd.append("price", $("#membershipPrice").val());
        fd.append("openHours", $("#membershipOpenHours").val());
        $("#membershipClassIds option:selected").each(function() {
            fd.append("classIds", $(this).val());
        });
        if ($("#membershipImage")[0].files[0]) fd.append("imageUrl", $("#membershipImage")[0].files[0]);

        $.ajax({
            url: "http://localhost:8080/api/v1/package/save",
            method: "POST",
            headers: authHeaders(),
            processData: false,
            contentType: false,
            data: fd,
            success: function(res) {
                if (res.code === 201) {
                    $("#addMembershipModal").modal("hide");
                    $("#addMembershipForm")[0].reset();
                    $("#membershipImagePreview").hide();
                    loadAllPackages();
                    alert("Package created successfully!");
                } else if (res.code === 406) {
                    alert("Package already exists. Please use a different name.");
                } else {
                    alert("Failed to create package: " + (res.message || "Unknown error"));
                }
            },
            error: function(xhr) {
                alert("Failed to create package: " + (xhr.responseJSON?.message || "Server error"));
            }
        });
    }

    function updatePackage(e) {
        e.preventDefault();
        const id = $("#editMembershipId").val();
        const fd = new FormData();
        fd.append("editMembershipName", $("#editMembershipName").val());
        fd.append("editMembershipDescription", $("#editMembershipDescription").val());
        fd.append("editMembershipPrice", $("#editMembershipPrice").val());
        fd.append("editMembershipOpenHours", $("#editMembershipOpenHours").val());
        $("#editMembershipClassIds option:selected").each(function() {
            fd.append("editMembershipClassIds", $(this).val());
        });
        if ($("#editMembershipImage")[0].files[0]) fd.append("editMembershipImage", $("#editMembershipImage")[0].files[0]);

        $.ajax({
            url: `http://localhost:8080/api/v1/package/update/${id}`,
            method: "POST",
            headers: authHeaders(),
            processData: false,
            contentType: false,
            data: fd,
            success: function(res) {
                if (res.code === 201) {
                    $("#editMembershipModal").modal("hide");
                    loadAllPackages();
                    alert("Package updated successfully!");
                } else {
                    alert("Failed to update package: " + (res.message || "Unknown error"));
                }
            },
            error: function(xhr) {
                alert("Failed to update package: " + (xhr.responseJSON?.message || "Server error"));
            }
        });
    }

    function deletePackage(id) {
        if (!confirm("Delete this package?")) return;
        $.ajax({
            url: `http://localhost:8080/api/v1/package/delete/${id}`,
            method: "DELETE",
            headers: authHeaders(),
            success: function() { loadAllPackages(); },
            error: function() { alert("Failed to delete package."); }
        });
    }

    // BOOKINGS
    function loadBookingOptions() {
        // Load Packages
        $.ajax({
            url: "http://localhost:8080/api/v1/package/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                const packages = res.data || [];
                const sel = $("#bookingPackage");
                sel.empty();
                packages.forEach(p => sel.append(`<option value="${p.name}">${p.name}</option>`));
            },
            error: function() { console.warn("Failed to load packages for booking."); }
        });

        // Load Classes
        $.ajax({
            url: "http://localhost:8080/api/v1/class/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                const classes = res.data || [];
                const sel = $("#bookingClass");
                sel.empty();
                classes.forEach(c => sel.append(`<option value="${c.name}">${c.name}</option>`));
            },
            error: function() { console.warn("Failed to load classes for booking."); }
        });

        // Load Coaches
        $.ajax({
            url: "http://localhost:8080/api/v1/guide/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                const coaches = res.data || [];
                const sel = $("#bookingCoach");
                sel.empty();
                coaches.forEach(c => sel.append(`<option value="${c.email}">${c.fullName}</option>`));
            },
            error: function() { console.warn("Failed to load coaches for booking."); }
        });

        // Load Locations
        $.ajax({
            url: "http://localhost:8080/api/v1/location/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                const locations = res.data || [];
                const sel = $("#bookingLocation");
                sel.empty();
                locations.forEach(l => sel.append(`<option value="${l.name}">${l.name}</option>`));
            },
            error: function() { console.warn("Failed to load locations for booking."); }
        });
    }

    function loadAllBookings() {
        $.ajax({
            url: "http://localhost:8080/api/v1/bookings/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                window.allBookings = res.data || [];
                renderBookings(window.allBookings);
            },
            error: function() { alert("Failed to load bookings."); }
        });
    }

    function renderBookings(bookings) {
        const tbody = $("#bookingTableBody");
        tbody.empty();
        bookings.forEach(b => {
            tbody.append(`
                <tr>
                    <td>${b.userEmail || "-"}</td>
                    <td>${b.packageName || "-"}</td>
                    <td>${b.className || "-"}</td>
                    <td>${b.coachEmail || "-"}</td>
                    <td>${b.locationName || "-"}</td>
                    <td>${b.bookingDate || "-"}</td>
                    <td>${b.endDate || "-"}</td>
                    <td>${b.numberOfSessions || 0}</td>
                    <td>LKR ${Number(b.packagePrice || 0).toFixed(2)}</td>
                    <td>LKR ${Number(b.coachFee || 0).toFixed(2)}</td>
                    <td>LKR ${Number(b.totalPrice || 0).toFixed(2)}</td>
                    <td><span class="badge bg-${b.status === 'ACTIVE' ? 'success' : b.status === 'COMPLETED' ? 'primary' : 'danger'}">${b.status || "-"}</span></td>
                </tr>
            `);
        });
    }

    function createBooking(e) {
        e.preventDefault();

        const formData = {
            userEmail: $("#bookingUserEmail").val(),
            packageName: $("#bookingPackage").val(),
            className: $("#bookingClass").val(),
            coachEmail: $("#bookingCoach").val(),
            locationName: $("#bookingLocation").val(),
            bookingDate: $("#bookingDate").val(),
            endDate: $("#bookingEndDate").val(),
            numberOfSessions: parseInt($("#bookingSessions").val()),
            packagePrice: parseFloat($("#bookingPackagePrice").val()),
            coachFee: parseFloat($("#bookingCoachFee").val()),
            totalPrice: parseFloat($("#bookingTotalPrice").val()),
            status: $("#bookingStatus").val()
        };

        $.ajax({
            url: "http://localhost:8080/api/v1/bookings/save",
            method: "POST",
            headers: { "Content-Type": "application/json", ...authHeaders() },
            data: JSON.stringify(formData),
            success: function(res) {
                if (res.code === 201) {
                    $("#addBookingModal").modal("hide");
                    $("#addBookingForm")[0].reset();
                    loadAllBookings();
                    alert("Booking created successfully!");
                } else {
                    alert("Failed to create booking: " + (res.message || "Unknown error"));
                }
            },
            error: function(xhr) {
                alert("Failed to create booking: " + (xhr.responseJSON?.message || "Server error"));
            }
        });
    }

    // PAYMENTS
    function loadAllPayments() {
        $.ajax({
            url: "http://localhost:8080/api/v1/payment/getAll",
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                window.allPayments = res.data || [];
                renderPayments(window.allPayments);
            },
            error: function() { alert("Failed to load payments."); }
        });
    }

    function renderPayments(payments) {
        const tbody = $("#paymentTableBody");
        tbody.empty();
        payments.forEach(p => {
            const cardNumberDisplay = p.cardNumber ? "**** **** **** " + (p.cardNumber.slice(-4) || "") : "-";
            const cvvDisplay = p.cvv ? "***" : "-";
            const paymentDateDisplay = p.paymentDate ? new Date(p.paymentDate).toLocaleString() : "-";
            tbody.append(`
            <tr>
                <td>${p.id || "-"}</td>
                <td>${p.userEmail || "-"}</td>
                <td>LKR ${Number(p.amount || 0).toFixed(2)}</td>
                <td>${p.cardHolderName || "-"}</td>
                <td>${cardNumberDisplay}</td>
                <td>${p.expiryDate || "-"}</td>
                <td>${cvvDisplay}</td>
                <td>${paymentDateDisplay}</td>
            </tr>
        `);
        });
    }


    // Add these to the $(document).ready function
    $("#searchReview").on("input", function(){
        const q = $(this).val().toLowerCase();
        const filtered = (window.allReviews || []).filter(r =>
            (r.userEmail || "").toLowerCase().includes(q) ||
            (r.rating || "").toString().includes(q) ||
            (r.comment || "").toLowerCase().includes(q)
        );
        renderReviews(filtered);
    });


    $(document).ready(function() {
        // Search filter
        $("#searchReview").on("input", function() {
            const q = $(this).val().toLowerCase();
            const filtered = (window.allReviews || []).filter(r =>
                (r.userEmail || "").toLowerCase().includes(q) ||
                (r.rating || "").toString().includes(q) ||
                (r.comment || "").toLowerCase().includes(q)
            );
            renderReviews(filtered);
        });


    });

    // Load all reviews from backend
    function loadAllReviews() {
        $.ajax({
            url: "http://localhost:8080/api/v1/user-reviews/getAll",
            method: "GET",
            success: function(res) {
                window.allReviews = res || [];
                renderReviews(window.allReviews);
            },
            error: function(xhr) {
                console.error(xhr);
                alert("Failed to load reviews.");
            }
        });
    }

    // Render reviews in table
    function renderReviews(reviews) {
        const tbody = $("#reviewTableBody");
        tbody.empty();
        reviews.forEach(r => {
            const createdAt = r.createdAt ? new Date(r.createdAt).toLocaleString() : "-";
            tbody.append(`
            <tr>
                <td>${r.reviewId || "-"}</td>
                <td>${r.userName || "-"}</td>
                <td>${r.userEmail || "-"}</td>
                <td>${r.rating || "-"}</td>
                <td>${r.comment || "-"}</td>
                <td>${createdAt}</td>
                <td>
                    <button class="btn btn-sm btn-danger" onclick="deleteReview(${r.reviewId})">Delete</button>
                </td>
            </tr>
        `);
        });
    }

    function deleteReview(id) {
        if (!confirm("Delete this review?")) return;
        $.ajax({
            url: `http://localhost:8080/api/v1/user-reviews/delete/${id}`,
            method: "DELETE",
            headers: authHeaders(),
            success: function() { loadAllReviews(); },
            error: function() { alert("Failed to delete review."); }
        });
    }

    // ATTENDANCE
    // Function to get auth headers (if you have JWT)
    function authHeaders() {
        return { "Authorization": "Bearer " + localStorage.getItem("token") };
    }

    // Load attendance records
    function loadAttendance() {
        const date = $("#attendanceDate").val();
        const search = $("#attendanceSearch").val();

        let url = "http://localhost:8080/api/v1/attendance/list";
        if (date || search) {
            url += "?";
            if (date) url += `date=${date}&`;
            if (search) url += `search=${encodeURIComponent(search)}&`;
            url = url.slice(0, -1); // Remove trailing &
        }

        $.ajax({
            url: url,
            method: "GET",
            headers: authHeaders(),
            success: function(res) {
                renderAttendance(res.data || []);
            },
            error: function() {
                alert("Failed to load attendance records.");
            }
        });
    }

    // Render attendance table
    function renderAttendance(records) {
        const tbody = $("#attendanceTableBody");
        tbody.empty();
        records.forEach(r => {
            tbody.append(`
            <tr>
                <td>${r.date || "-"}</td>
                <td>${r.memberName || "-"}</td>
                <td>${r.email || "-"}</td>
                <td>${r.checkIn || "-"}</td>
                <td>${r.checkOut || "-"}</td>
                <td>
                    <span class="badge bg-${
                r.status === 'Present' || r.status === 'PRESENT' ? 'success' :
                    r.status === 'Late' ? 'warning' :
                        r.status === 'Completed' ? 'info' : 'secondary'
            }">${r.status || "-"}</span>
                </td>
            </tr>
        `);
        });
    }

    // Handle marking attendance
    $("#addAttendanceForm").on("submit", function(e) {
        e.preventDefault();

        const formData = {
            email: $("#attendanceEmail").val(),
            date: $("#attendanceMarkDate").val(),
            checkIn: $("#attendanceCheckIn").val() || null,
            checkOut: $("#attendanceCheckOut").val() || null
        };

        $.ajax({
            url: "http://localhost:8080/api/v1/attendance/mark",
            method: "POST",
            headers: { "Content-Type": "application/json", ...authHeaders() },
            data: JSON.stringify(formData),
            success: function(res) {
                $("#addAttendanceModal").modal("hide");
                $("#addAttendanceForm")[0].reset();
                loadAttendance();
                alert("Attendance marked successfully!");
            },
            error: function(xhr) {
                alert("Failed to mark attendance: " + (xhr.responseJSON?.message || "Server error"));
            }
        });
    });


    // Initialize todays date in filter and modal
    $(document).ready(function() {
        const today = new Date().toISOString().split('T')[0];
        $("#attendanceDate, #attendanceMarkDate").val(today);
        loadAttendance();
    });

</script>

<!-- Bootstrap JS Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>







































<!--correct code without location-->
<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8" />-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>-->
<!--    <title>GymNest Admin Panel</title>-->

<!--    &lt;!&ndash; Fonts &ndash;&gt;-->
<!--    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">-->

<!--    &lt;!&ndash; Bootstrap + Icons + Font Awesome &ndash;&gt;-->
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>-->
<!--    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>-->

<!--    &lt;!&ndash; jQuery + ChartJS &ndash;&gt;-->
<!--    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>-->
<!--    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>-->

<!--    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>-->

<!--    <style>-->
<!--        :root{-->
<!--            &#45;&#45;accent: #ff6a00;-->
<!--            &#45;&#45;accent-2: #ff8c2b;-->
<!--            &#45;&#45;black-900: #0c0f14;-->
<!--            &#45;&#45;black-800: #11151b;-->
<!--            &#45;&#45;black-700: #171b22;-->
<!--            &#45;&#45;white: #ffffff;-->
<!--            &#45;&#45;text-strong: #0f172a;-->
<!--            &#45;&#45;text: #1f2937;-->
<!--            &#45;&#45;muted: #6b7280;-->
<!--            &#45;&#45;border: #e5e7eb;-->
<!--            &#45;&#45;surface: #ffffff;-->
<!--            &#45;&#45;surface-2: #f7f8fb;-->
<!--        }-->

<!--        * { box-sizing: border-box; }-->

<!--        /* Keep page flexible; don't lock height */-->
<!--        html, body { height: auto; min-height: 100vh; }-->

<!--        body {-->
<!--            display: flex;-->
<!--            flex-wrap: wrap;-->
<!--            min-height: 100vh;-->
<!--            font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji", "Segoe UI Symbol", sans-serif;-->
<!--            color: var(&#45;&#45;text);-->
<!--            background: radial-gradient(1200px 600px at 10% -10%, #fff 0%, #fafbff 50%, #f5f6fb 100%);-->
<!--        }-->

<!--        /* Sidebar */-->
<!--        .sidebar {-->
<!--            width: 260px;-->
<!--            height: 100dvh;-->
<!--            position: fixed;-->
<!--            top: 0; left: 0;-->
<!--            background: linear-gradient(180deg, var(&#45;&#45;black-900) 0%, var(&#45;&#45;black-800) 60%, var(&#45;&#45;black-700) 100%);-->
<!--            color: var(&#45;&#45;white);-->
<!--            padding: 22px 18px;-->
<!--            border-right: 1px solid rgba(255,255,255,0.06);-->
<!--            overflow-y: auto;-->
<!--            -webkit-overflow-scrolling: touch;-->
<!--            scrollbar-gutter: stable;-->
<!--            padding-bottom: 16px;-->
<!--        }-->
<!--        @supports not (height: 100dvh) {-->
<!--            .sidebar { height: 100vh; }-->
<!--        }-->

<!--        .sidebar h2 {-->
<!--            font-weight: 700;-->
<!--            letter-spacing: 0.3px;-->
<!--            color: var(&#45;&#45;white);-->
<!--        }-->
<!--        .sidebar h2::after{-->
<!--            content:"";-->
<!--            display:block;-->
<!--            height:3px;-->
<!--            width:60px;-->
<!--            margin:10px auto 0;-->
<!--            border-radius: 3px;-->
<!--            background: linear-gradient(90deg, var(&#45;&#45;accent), var(&#45;&#45;accent-2));-->
<!--        }-->

<!--        .sidebar a {-->
<!--            color: #d1d5db;-->
<!--            text-decoration: none;-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 10px;-->
<!--            padding: 12px 14px;-->
<!--            margin: 6px 6px;-->
<!--            cursor: pointer;-->
<!--            border-radius: 10px;-->
<!--            transition: all .2s ease;-->
<!--            position: relative;-->
<!--            font-weight: 500;-->
<!--        }-->
<!--        .sidebar a i { width: 20px; text-align: center; }-->
<!--        .sidebar a:hover {-->
<!--            color: #f3f4f6;-->
<!--            background: rgba(255,255,255,0.06);-->
<!--            transform: translateX(2px);-->
<!--        }-->
<!--        .sidebar a.active {-->
<!--            color: #ffffff;-->
<!--            background: rgba(255, 106, 0, 0.15);-->
<!--            box-shadow: inset 0 0 0 1px rgba(255,106,0,0.35);-->
<!--        }-->
<!--        .sidebar a.active::before {-->
<!--            content:"";-->
<!--            position: absolute;-->
<!--            left: -6px; top: 8px; bottom: 8px;-->
<!--            width: 4px;-->
<!--            border-radius: 8px;-->
<!--            background: linear-gradient(180deg, var(&#45;&#45;accent), var(&#45;&#45;accent-2));-->
<!--            box-shadow: 0 0 12px rgba(255,106,0,0.6);-->
<!--        }-->
<!--        .sidebar .mt-auto {-->
<!--            margin-top: auto;-->
<!--            padding: 8px 10px 0;-->
<!--            border-top: 1px solid rgba(255,255,255,0.06);-->
<!--        }-->
<!--        .sidebar .btn-danger {-->
<!--            background: linear-gradient(180deg, #ff3b30, #d42a21);-->
<!--            border: none;-->
<!--            font-weight: 600;-->
<!--            letter-spacing: .2px;-->
<!--        }-->
<!--        .sidebar .btn-danger:hover { filter: brightness(1.03); }-->

<!--        /* Content */-->
<!--        .content {-->
<!--            flex-grow: 1;-->
<!--            padding: 26px;-->
<!--            margin-left: 260px;-->
<!--            transition: margin-left 0.3s ease;-->
<!--            width: calc(100% - 260px);-->
<!--        }-->

<!--        /* Cards */-->
<!--        .card {-->
<!--            border: 1px solid var(&#45;&#45;border);-->
<!--            border-radius: 16px;-->
<!--            background: var(&#45;&#45;surface);-->
<!--            box-shadow: 0 6px 20px rgba(16, 24, 40, 0.06);-->
<!--        }-->
<!--        .card .card-icon i {-->
<!--            background: linear-gradient(135deg, rgba(255,106,0,0.12), rgba(255,140,43,0.2));-->
<!--            color: var(&#45;&#45;accent);-->
<!--            border-radius: 12px;-->
<!--            width: 56px; height: 56px;-->
<!--            display: grid;-->
<!--            place-items: center;-->
<!--            font-size: 1.4rem;-->
<!--            box-shadow: 0 2px 10px rgba(255,106,0,0.15) inset;-->
<!--        }-->
<!--        h2, h5, h6 { color: var(&#45;&#45;text-strong); }-->

<!--        /* Buttons */-->
<!--        .btn-primary {-->
<!--            background: linear-gradient(180deg, var(&#45;&#45;accent), var(&#45;&#45;accent-2));-->
<!--            border: none;-->
<!--            font-weight: 600;-->
<!--            letter-spacing: .2px;-->
<!--            box-shadow: 0 8px 20px rgba(255,106,0,0.25);-->
<!--        }-->
<!--        .btn-primary:hover { filter: brightness(1.03); }-->
<!--        .btn-outline-primary {-->
<!--            color: var(&#45;&#45;accent);-->
<!--            border-color: var(&#45;&#45;accent);-->
<!--            font-weight: 600;-->
<!--        }-->
<!--        .btn-outline-primary:hover {-->
<!--            background: var(&#45;&#45;accent);-->
<!--            color: #fff;-->
<!--        }-->

<!--        /* Forms */-->
<!--        .form-control:focus, .form-select:focus {-->
<!--            border-color: var(&#45;&#45;accent);-->
<!--            box-shadow: 0 0 0 .2rem rgba(255,106,0,.2);-->
<!--        }-->

<!--        /* Tables */-->
<!--        .table {-->
<!--            border-color: var(&#45;&#45;border);-->
<!--            background: var(&#45;&#45;surface);-->
<!--        }-->
<!--        .table thead.table-dark th {-->
<!--            background: var(&#45;&#45;black-900) !important;-->
<!--            color: #eef2ff !important;-->
<!--            border-color: #1f2937 !important;-->
<!--            position: relative;-->
<!--        }-->
<!--        .table thead.table-dark th:first-child::before {-->
<!--            content:"";-->
<!--            position:absolute;-->
<!--            left:0; top:0; height:100%; width:4px;-->
<!--            background: linear-gradient(180deg, var(&#45;&#45;accent), var(&#45;&#45;accent-2));-->
<!--        }-->
<!--        .table tbody tr:hover {-->
<!--            background: #fff7f1;-->
<!--        }-->

<!--        /* Horizontal Scroll Row */-->
<!--        .scroll-row {-->
<!--            display: flex;-->
<!--            gap: 16px;-->
<!--            overflow-x: auto;-->
<!--            padding-bottom: 12px;-->
<!--            scrollbar-width: thin;-->
<!--        }-->

<!--        .scroll-row::-webkit-scrollbar {-->
<!--            height: 8px;-->
<!--        }-->

<!--        .scroll-row::-webkit-scrollbar-thumb {-->
<!--            background: rgba(0,0,0,0.2);-->
<!--            border-radius: 6px;-->
<!--        }-->

<!--        /* Compact Stat Cards */-->
<!--        .small-card {-->
<!--            min-width: 200px;-->
<!--            flex: 0 0 auto;-->
<!--            padding: 16px;-->
<!--            border-radius: 14px;-->
<!--            background: linear-gradient(145deg, #fff, #f9fafc);-->
<!--            box-shadow: 0 4px 14px rgba(16, 24, 40, 0.08);-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 14px;-->
<!--            transition: transform 0.2s ease, box-shadow 0.2s ease;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .small-card:hover {-->
<!--            transform: translateY(-4px);-->
<!--            box-shadow: 0 8px 20px rgba(255, 106, 0, 0.2);-->
<!--        }-->

<!--        .stat-icon {-->
<!--            width: 50px;-->
<!--            height: 50px;-->
<!--            border-radius: 12px;-->
<!--            display: grid;-->
<!--            place-items: center;-->
<!--            font-size: 1.5rem;-->
<!--            background: linear-gradient(135deg, rgba(255,106,0,0.15), rgba(255,140,43,0.3));-->
<!--            color: var(&#45;&#45;accent, #ff6a00);-->
<!--            box-shadow: inset 0 2px 6px rgba(255,106,0,0.15);-->
<!--        }-->

<!--        /* Different accent colors for sample cards */-->
<!--        .sample1 {-->
<!--            background: linear-gradient(135deg, rgba(0,123,255,0.15), rgba(0,123,255,0.35));-->
<!--            color: #007bff;-->
<!--        }-->

<!--        .sample2 {-->
<!--            background: linear-gradient(135deg, rgba(40,167,69,0.15), rgba(40,167,69,0.35));-->
<!--            color: #28a745;-->
<!--        }-->

<!--        .stat-info h6 {-->
<!--            font-size: 0.75rem;-->
<!--            font-weight: 600;-->
<!--            color: var(&#45;&#45;muted, #6c757d);-->
<!--            margin-bottom: 2px;-->
<!--            text-transform: uppercase;-->
<!--            letter-spacing: 0.4px;-->
<!--        }-->

<!--        .stat-info h2 {-->
<!--            font-size: 1.4rem;-->
<!--            font-weight: 700;-->
<!--            color: var(&#45;&#45;text-strong, #222);-->
<!--            margin: 0;-->
<!--        }-->

<!--        .chart-card {-->
<!--            background: #fff;-->
<!--            padding: 20px;-->
<!--            border-radius: 14px;-->
<!--            box-shadow: 0 4px 14px rgba(16, 24, 40, 0.08);-->
<!--        }-->

<!--        .chart-title {-->
<!--            font-size: 0.9rem;-->
<!--            font-weight: 600;-->
<!--            margin-bottom: 12px;-->
<!--            color: #333;-->
<!--        }-->

<!--        /* Badges override hint (kept Bootstrap colors for statuses) */-->
<!--        .badge { font-weight: 600; }-->

<!--        /* Charts wrappers */-->
<!--        .chart-card {-->
<!--            border-radius: 16px;-->
<!--            overflow: hidden;-->
<!--        }-->

<!--        /* Utilities */-->
<!--        .hidden { display: none; }-->

<!--        /* Responsive */-->
<!--        @media (max-width: 992px) {-->
<!--            .sidebar { width: 100%; height: auto; position: relative; }-->
<!--            .content { margin-left: 0; width: 100%; }-->
<!--        }-->

<!--        /* Scrollbar */-->
<!--        ::-webkit-scrollbar { width: 10px; height: 10px; }-->
<!--        ::-webkit-scrollbar-thumb {-->
<!--            background: linear-gradient(180deg, var(&#45;&#45;accent), var(&#45;&#45;accent-2));-->
<!--            border-radius: 10px;-->
<!--        }-->
<!--        ::-webkit-scrollbar-track { background: #f1f1f1; }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--&lt;!&ndash; Sidebar &ndash;&gt;-->
<!--<div class="sidebar d-flex flex-column">-->
<!--    <h2 class="text-center mb-3">GymNest Fitness Center</h2>-->

<!--    <a class="active" onclick="showPanel('dashboard')"><i class="fas fa-gauge"></i> Dashboard</a>-->
<!--    <a onclick="showPanel('members')"><i class="fas fa-users"></i> Members</a>-->
<!--    <a onclick="showPanel('guides')"><i class="fas fa-user-tie"></i> Guides</a>-->
<!--    <a onclick="showPanel('classes')"><i class="fas fa-dumbbell"></i> Classes</a>-->
<!--    <a onclick="showPanel('locations')"><i class="fas fa-location-dot"></i></i> Locations</a>-->
<!--    <a onclick="showPanel('memberships')"><i class="fas fa-id-card"></i> Memberships</a>-->
<!--    <a onclick="showPanel('bookings')"><i class="fas fa-book"></i> Bookings</a>-->
<!--    <a onclick="showPanel('payments')"><i class="fas fa-credit-card"></i> Payments</a>-->
<!--    <a onclick="showPanel('reviews')"><i class="fas fa-star"></i> Reviews</a>-->
<!--    <a onclick="showPanel('attendance')"><i class="fas fa-calendar-check"></i> Attendance</a>-->

<!--    <div class="mt-auto">-->
<!--        <h6 class="mb-2 text-white-50">Welcome back</h6>-->
<!--        <h5 class="mb-3 text-white">Hi, <span id="adminName">admin</span></h5>-->
<!--        <button class="btn btn-danger w-100" onclick="logout()">Log Out</button>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Content &ndash;&gt;-->
<!--<div class="content">-->
<!--    &lt;!&ndash; Dashboard &ndash;&gt;-->
<!--    <div class="container mt-2" id="dashboard">-->
<!--        <h2 class="mb-4">Welcome to GymNest Dashboard</h2>-->

<!--        &lt;!&ndash; Scrollable Row &ndash;&gt;-->
<!--        <div class="scroll-row">-->
<!--            &lt;!&ndash; Sample Card: Revenue &ndash;&gt;-->
<!--            <div class="stat-card small-card">-->
<!--                <div class="stat-icon sample1"><i class="fas fa-coins"></i></div>-->
<!--                <div class="stat-info">-->
<!--                    <h6>Revenue</h6>-->
<!--                    <h2>$12K</h2>-->
<!--                </div>-->
<!--            </div>-->

<!--            &lt;!&ndash; Sample Card: Feedback &ndash;&gt;-->
<!--            <div class="stat-card small-card">-->
<!--                <div class="stat-icon sample2"><i class="fas fa-star"></i></div>-->
<!--                <div class="stat-info">-->
<!--                    <h6>Feedback</h6>-->
<!--                    <h2>92%</h2>-->
<!--                </div>-->
<!--            </div>-->

<!--            &lt;!&ndash; Total Members &ndash;&gt;-->
<!--            <div class="stat-card small-card">-->
<!--                <div class="stat-icon"><i class="fas fa-users"></i></div>-->
<!--                <div class="stat-info">-->
<!--                    <h6>Total Members</h6>-->
<!--                    <h2 id="totalMembers">0</h2>-->
<!--                </div>-->
<!--            </div>-->

<!--            &lt;!&ndash; Active Memberships &ndash;&gt;-->
<!--            <div class="stat-card small-card">-->
<!--                <div class="stat-icon"><i class="fas fa-bolt"></i></div>-->
<!--                <div class="stat-info">-->
<!--                    <h6>Active Memberships</h6>-->
<!--                    <h2 id="activeMemberships">0</h2>-->
<!--                </div>-->
<!--            </div>-->

<!--            &lt;!&ndash; Total Guides &ndash;&gt;-->
<!--            <div class="stat-card small-card">-->
<!--                <div class="stat-icon"><i class="fas fa-user-tie"></i></div>-->
<!--                <div class="stat-info">-->
<!--                    <h6>Total Guides</h6>-->
<!--                    <h2 id="totalGuides">0</h2>-->
<!--                </div>-->
<!--            </div>-->

<!--            &lt;!&ndash; Per-Day Bookings &ndash;&gt;-->
<!--            <div class="stat-card small-card">-->
<!--                <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>-->
<!--                <div class="stat-info">-->
<!--                    <h6>Bookings Today</h6>-->
<!--                    <h2 id="perDayBookings">0</h2>-->
<!--                </div>-->
<!--            </div>-->

<!--            &lt;!&ndash; Total Classes &ndash;&gt;-->
<!--            <div class="stat-card small-card">-->
<!--                <div class="stat-icon"><i class="fas fa-dumbbell"></i></div>-->
<!--                <div class="stat-info">-->
<!--                    <h6>Total Classes</h6>-->
<!--                    <h2 id="totalClasses">0</h2>-->
<!--                </div>-->
<!--            </div>-->

<!--            &lt;!&ndash; Total Locations &ndash;&gt;-->
<!--            <div class="stat-card small-card">-->
<!--                <div class="stat-icon"><i class="fas fa-map-marker-alt"></i></div>-->
<!--                <div class="stat-info">-->
<!--                    <h6>Total Locations</h6>-->
<!--                    <h2 id="totalLocations">0</h2>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; Charts Section &ndash;&gt;-->
<!--    <div class="row mt-4">-->
<!--        &lt;!&ndash; Membership Growth Chart &ndash;&gt;-->
<!--        <div class="col-md-6 mb-4">-->
<!--            <div class="chart-card">-->
<!--                <h6 class="chart-title">Membership Growth</h6>-->
<!--                <canvas id="membershipChart"></canvas>-->
<!--            </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; Revenue Breakdown Chart &ndash;&gt;-->
<!--        <div class="col-md-6 mb-4">-->
<!--            <div class="chart-card">-->
<!--                <h6 class="chart-title">Revenue Breakdown</h6>-->
<!--                <canvas id="revenueChart"></canvas>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->




<!--    &lt;!&ndash; Members &ndash;&gt;-->
<!--    <div id="members" class="hidden">-->
<!--        <div class="d-flex justify-content-between align-items-center mb-3">-->
<!--            <h2>Member Management</h2>-->
<!--            <div class="d-flex gap-2">-->
<!--                <input type="text" id="searchMember" class="form-control" placeholder="Search by Name or Email" style="min-width: 260px;">-->
<!--                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMemberModal"><i class="fas fa-user-plus me-2"></i>Add Member</button>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card p-3">-->
<!--            <div class="table-responsive">-->
<!--                <table class="table table-bordered align-middle mb-0">-->
<!--                    <thead class="table-dark">-->
<!--                    <tr>-->
<!--                        <th>Name</th>-->
<!--                        <th>Email</th>-->
<!--                        <th>Contact</th>-->
<!--                        <th>Role</th>-->
<!--                        <th style="width: 160px;">Actions</th>-->
<!--                    </tr>-->
<!--                    </thead>-->
<!--                    <tbody id="memberTableBody"></tbody>-->
<!--                </table>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; Guides &ndash;&gt;-->
<!--    <div id="guides" class="hidden">-->
<!--        <div class="d-flex justify-content-between align-items-center mb-3">-->
<!--            <h2>Guide Management</h2>-->
<!--            <div class="d-flex gap-2">-->
<!--                <input type="text" id="searchGuide" class="form-control" placeholder="Search Guides by Name or Email" style="min-width: 260px;">-->
<!--                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addGuideModal"><i class="fas fa-user-tie me-2"></i>Add Guide</button>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card p-3">-->
<!--            <div class="table-responsive">-->
<!--                <table class="table table-bordered align-middle mb-0">-->
<!--                    <thead class="table-dark">-->
<!--                    <tr>-->
<!--                        <th>Full Name</th>-->
<!--                        <th>Email</th>-->
<!--                        <th>Image</th>-->
<!--                        <th>Description</th>-->
<!--                        <th>Payment per hour</th>-->
<!--                        <th>Phone</th>-->
<!--                        <th>Status</th>-->
<!--                        <th>Booked</th>-->
<!--                        <th style="width: 180px;">Actions</th>-->
<!--                    </tr>-->
<!--                    </thead>-->
<!--                    <tbody id="guideTableBody"></tbody>-->
<!--                </table>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; Classes &ndash;&gt;-->
<!--    <div id="classes" class="hidden">-->
<!--        <div class="d-flex justify-content-between align-items-center mb-3">-->
<!--            <h2>Class Management</h2>-->
<!--            <div class="d-flex gap-2">-->
<!--                <input type="text" id="searchClass" class="form-control" placeholder="Search by Name or Guide" style="min-width: 260px;">-->
<!--                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addClassModal"><i class="fas fa-dumbbell me-2"></i>Add Class</button>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card p-3">-->
<!--            <div class="table-responsive">-->
<!--                <table class="table table-bordered align-middle mb-0">-->
<!--                    <thead class="table-dark">-->
<!--                    <tr>-->
<!--                        <th>Name</th>-->
<!--                        <th>Guide</th>-->
<!--                        <th>Day</th>-->
<!--                        <th>Time</th>-->
<!--                        <th>Capacity</th>-->
<!--                        <th>Enrolled</th>-->
<!--                        <th>Status</th>-->
<!--                        <th style="width: 180px;">Actions</th>-->
<!--                    </tr>-->
<!--                    </thead>-->
<!--                    <tbody id="classTableBody"></tbody>-->
<!--                </table>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; Locations &ndash;&gt;-->
<!--    <div id="locations" class="hidden">-->
<!--        <div class="d-flex justify-content-between align-items-center mb-3">-->
<!--            <h2>Location Management</h2>-->
<!--            <div class="d-flex gap-2">-->
<!--                <input type="text" id="searchLocation" class="form-control" placeholder="Search by Name or Address" style="min-width: 260px;">-->
<!--                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addLocationModal"><i class="fas fa-map-marker-alt me-2"></i>Add Location</button>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card p-3">-->
<!--            <div class="table-responsive">-->
<!--                <table class="table table-bordered align-middle mb-0">-->
<!--                    <thead class="table-dark">-->
<!--                    <tr>-->
<!--                        <th>Name</th>-->
<!--                        <th>Description</th>-->
<!--                        <th>Address</th>-->
<!--                        <th>Open Hours</th>-->
<!--                        <th>Image</th>-->
<!--                        <th style="width: 180px;">Actions</th>-->
<!--                    </tr>-->
<!--                    </thead>-->
<!--                    <tbody id="locationTableBody"></tbody>-->
<!--                </table>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->


<!--    &lt;!&ndash; Memberships &ndash;&gt;-->
<!--    <div id="memberships" class="hidden">-->
<!--        <div class="d-flex justify-content-between align-items-center mb-3">-->
<!--            <h2>Membership Plans</h2>-->
<!--            <div class="d-flex gap-2">-->
<!--                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMembershipModal"><i class="fas fa-id-card me-2"></i>Add Plan</button>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card p-3">-->
<!--            <div class="table-responsive">-->
<!--                <table class="table table-bordered align-middle mb-0">-->
<!--                    <thead class="table-dark">-->
<!--                    <tr>-->
<!--                        <th>ID</th>-->
<!--                        <th>Name</th>-->
<!--                        <th>Description</th>-->
<!--                        <th>Price (LKR)</th>-->
<!--                        <th>Image</th>-->
<!--                        <th>Open Hours</th>-->
<!--                        <th>Classes</th>-->
<!--                        <th style="width: 180px;">Actions</th>-->
<!--                    </tr>-->
<!--                    </thead>-->
<!--                    <tbody id="membershipTableBody"></tbody>-->
<!--                </table>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; Bookings &ndash;&gt;-->
<!--    <div id="bookings" class="hidden">-->
<!--        <div class="d-flex justify-content-between align-items-center mb-3">-->
<!--            <h2>Booking Management</h2>-->
<!--            <div class="d-flex gap-2">-->
<!--                <input type="text" id="searchBooking" class="form-control" placeholder="Search by User Email" style="min-width: 260px;">-->
<!--                &lt;!&ndash;                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addBookingModal"><i class="fas fa-book me-2"></i>Add Booking</button>&ndash;&gt;-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card p-3">-->
<!--            <div class="table-responsive">-->
<!--                <table class="table table-bordered align-middle mb-0">-->
<!--                    <thead class="table-dark">-->
<!--                    <tr>-->
<!--                        <th>User Email</th>-->
<!--                        <th>Package</th>-->
<!--                        <th>Class</th>-->
<!--                        <th>Coach</th>-->
<!--                        <th>Location</th>-->
<!--                        <th>Booking Date</th>-->
<!--                        <th>End Date</th>-->
<!--                        <th>Sessions</th>-->
<!--                        <th>Package Price</th>-->
<!--                        <th>Coach Fee</th>-->
<!--                        <th>Total Price</th>-->
<!--                        <th>Status</th>-->
<!--                    </tr>-->
<!--                    </thead>-->
<!--                    <tbody id="bookingTableBody"></tbody>-->
<!--                </table>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; Payments &ndash;&gt;-->
<!--    &lt;!&ndash; Payments (updated) &ndash;&gt;-->
<!--    <div id="payments" class="hidden">-->
<!--        <h2>Payment Management</h2>-->
<!--        <div class="card p-3">-->
<!--            <input type="text" id="searchPaymentEmail" class="form-control mb-3" placeholder="Search by member email...">-->
<!--            <div class="table-responsive">-->
<!--                <table class="table table-bordered align-middle mb-0">-->
<!--                    <thead class="table-dark">-->
<!--                    <tr>-->
<!--                        <th>ID</th>-->
<!--                        <th>Member Email</th>-->
<!--                        <th>Amount (LKR)</th>-->
<!--                        <th>Card Holder</th>-->
<!--                        <th>Card Number</th>-->
<!--                        <th>Expiry Date</th>-->
<!--                        <th>CVV</th>-->
<!--                        <th>Payment Date</th>-->
<!--                    </tr>-->
<!--                    </thead>-->
<!--                    <tbody id="paymentTableBody"></tbody>-->
<!--                </table>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash;reviews&ndash;&gt;-->
<!--    <div id="reviews" class="hidden">-->
<!--        <div class="d-flex justify-content-between align-items-center mb-3">-->
<!--            <h2>Review Management</h2>-->
<!--            <div class="d-flex gap-2">-->
<!--                <input type="text" id="searchReview" class="form-control" placeholder="Search by User Email, Rating or Comment" style="min-width: 260px;">-->
<!--                &lt;!&ndash;                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addReviewModal"><i class="fas fa-star me-2"></i>Add Review</button>&ndash;&gt;-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card p-3">-->
<!--            <div class="table-responsive">-->
<!--                <table class="table table-bordered align-middle mb-0">-->
<!--                    <thead class="table-dark">-->
<!--                    <tr>-->
<!--                        <th>ID</th>-->
<!--                        <th>User Name</th>-->
<!--                        <th>User Email</th>-->
<!--                        <th>Rating</th>-->
<!--                        <th>Comment</th>-->
<!--                        <th>Created At</th>-->
<!--                        <th style="width: 180px;">Actions</th>-->
<!--                    </tr>-->
<!--                    </thead>-->
<!--                    <tbody id="reviewTableBody"></tbody>-->
<!--                </table>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; Attendance &ndash;&gt;-->
<!--    <div id="attendance" class="hidden">-->
<!--        <div class="d-flex justify-content-between align-items-center mb-3">-->
<!--            <h2>Attendance</h2>-->
<!--            <div class="d-flex gap-2">-->
<!--                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addAttendanceModal"><i class="fas fa-calendar-plus me-2"></i>Mark Attendance</button>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card p-3 mb-3">-->
<!--            <div class="row g-2">-->
<!--                <div class="col-md-4">-->
<!--                    <input type="date" id="attendanceDate" class="form-control" value="<?php echo date('Y-m-d'); ?>"/>-->
<!--                </div>-->
<!--                <div class="col-md-4">-->
<!--                    <input type="text" id="attendanceSearch" class="form-control" placeholder="Search by email or name"/>-->
<!--                </div>-->
<!--                <div class="col-md-4 d-grid">-->
<!--                    <button class="btn btn-outline-primary" onclick="loadAttendance()">Filter</button>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card p-3">-->
<!--            <div class="table-responsive">-->
<!--                <table class="table table-bordered align-middle mb-0">-->
<!--                    <thead class="table-dark">-->
<!--                    <tr>-->
<!--                        <th>Date</th>-->
<!--                        <th>Member</th>-->
<!--                        <th>Email</th>-->
<!--                        <th>Check-In</th>-->
<!--                        <th>Check-Out</th>-->
<!--                        <th>Status</th>-->
<!--                    </tr>-->
<!--                    </thead>-->
<!--                    <tbody id="attendanceTableBody"></tbody>-->
<!--                </table>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Modals &ndash;&gt;-->

<!--&lt;!&ndash; Add Member Modal &ndash;&gt;-->
<!--<div class="modal fade" id="addMemberModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="addMemberForm">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Add Member</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <div class="mb-3"><label class="form-label">Full Name</label><input type="text" class="form-control" id="memberName" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Email</label><input type="email" class="form-control" id="memberEmail" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Phone</label><input type="text" class="form-control" id="memberPhone" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Password</label><input type="password" class="form-control" id="memberPassword" required></div>-->
<!--                </div>-->
<!--                <div class="modal-footer"><button type="submit" class="btn btn-success">Create Member</button></div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Add Guide Modal &ndash;&gt;-->
<!--<div class="modal fade" id="addGuideModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="addGuideForm" enctype="multipart/form-data">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Add Guide</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <div class="mb-3"><label class="form-label">Full Name</label><input type="text" class="form-control" id="guideName" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Email</label><input type="email" class="form-control" id="guideEmail" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Phone</label><input type="text" class="form-control" id="guidePhone" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Description</label><input type="text" class="form-control" id="guideDescription" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Rate per Hour</label><input type="number" class="form-control" id="guidePaymentPerHour" required></div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Image</label>-->
<!--                        <input type="file" class="form-control" id="guideImage" accept="image/*">-->
<!--                        <img id="guideImagePreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="modal-footer"><button type="submit" class="btn btn-success">Save Guide</button></div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Edit Guide Modal &ndash;&gt;-->
<!--<div class="modal fade" id="editGuideModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="editGuideForm" enctype="multipart/form-data">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Edit Guide</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <input type="hidden" id="editGuideEmail">-->
<!--                    <div class="mb-3"><label class="form-label">Full Name</label><input type="text" class="form-control" id="editGuideName"></div>-->
<!--                    <div class="mb-3"><label class="form-label">Email</label><input type="email" class="form-control" id="editGuideEmailDisplay" disabled></div>-->
<!--                    <div class="mb-3"><label class="form-label">Phone</label><input type="text" class="form-control" id="editGuidePhone"></div>-->
<!--                    <div class="mb-3"><label class="form-label">Description</label><input type="text" class="form-control" id="editGuideDescription"></div>-->
<!--                    <div class="mb-3"><label class="form-label">Rate per Hour</label><input type="number" class="form-control" id="editGuidePaymentPerHour"></div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Image</label>-->
<!--                        <input type="file" class="form-control" id="editGuideImage" accept="image/*">-->
<!--                        <img id="editGuideImgPreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="modal-footer">-->
<!--                    <button type="submit" class="btn btn-success">Update Guide</button>-->
<!--                    <button type="button" class="btn btn-outline-secondary" id="toggleStatusBtn" onclick="toggleGuideStatus()">Toggle Status</button>-->
<!--                </div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Add Class Modal &ndash;&gt;-->
<!--<div class="modal fade" id="addClassModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="addClassForm">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Add Class</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <div class="mb-3"><label class="form-label">Class Name</label><input type="text" class="form-control" id="className" required></div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Guide</label>-->
<!--                        <select id="classGuide" class="form-control" required></select>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Day of Week</label>-->
<!--                        <select id="classDay" class="form-control" required>-->
<!--                            <option value="Monday">Monday</option>-->
<!--                            <option value="Tuesday">Tuesday</option>-->
<!--                            <option value="Wednesday">Wednesday</option>-->
<!--                            <option value="Thursday">Thursday</option>-->
<!--                            <option value="Friday">Friday</option>-->
<!--                            <option value="Saturday">Saturday</option>-->
<!--                            <option value="Sunday">Sunday</option>-->
<!--                        </select>-->
<!--                    </div>-->
<!--                    <div class="mb-3"><label class="form-label">Start Time</label><input type="time" class="form-control" id="classStart" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">End Time</label><input type="time" class="form-control" id="classEnd" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Capacity</label><input type="number" class="form-control" id="classCapacity" required></div>-->
<!--                </div>-->
<!--                <div class="modal-footer"><button type="submit" class="btn btn-success">Create Class</button></div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Edit Class Modal &ndash;&gt;-->
<!--<div class="modal fade" id="editClassModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="editClassForm">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Edit Class</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <input type="hidden" id="editClassId">-->
<!--                    <div class="mb-3"><label class="form-label">Class Name</label><input type="text" class="form-control" id="editClassName" required></div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Guide</label>-->
<!--                        <select id="editClassGuide" class="form-control" required></select>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Day of Week</label>-->
<!--                        <select id="editClassDay" class="form-control" required>-->
<!--                            <option value="Monday">Monday</option>-->
<!--                            <option value="Tuesday">Tuesday</option>-->
<!--                            <option value="Wednesday">Wednesday</option>-->
<!--                            <option value="Thursday">Thursday</option>-->
<!--                            <option value="Friday">Friday</option>-->
<!--                            <option value="Saturday">Saturday</option>-->
<!--                            <option value="Sunday">Sunday</option>-->
<!--                        </select>-->
<!--                    </div>-->
<!--                    <div class="mb-3"><label class="form-label">Start Time</label><input type="time" class="form-control" id="editClassStart" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">End Time</label><input type="time" class="form-control" id="editClassEnd" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Capacity</label><input type="number" class="form-control" id="editClassCapacity" required></div>-->
<!--                </div>-->
<!--                <div class="modal-footer"><button type="submit" class="btn btn-success">Update Class</button></div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Add Location Modal &ndash;&gt;-->
<!--<div class="modal fade" id="addLocationModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="addLocationForm" enctype="multipart/form-data">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Add Location</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Name</label>-->
<!--                        <input type="text" class="form-control" id="locationName" name="name" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Description</label>-->
<!--                        <input type="text" class="form-control" id="locationDescription" name="description" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Address</label>-->
<!--                        <input type="text" class="form-control" id="locationAddress" name="address" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Open Hours</label>-->
<!--                        <input type="text" class="form-control" id="locationOpenHours" name="openHours" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Image</label>-->
<!--                        <input type="file" class="form-control" id="locationImage" name="imageUrl" accept="image/*">-->
<!--                        <img id="locationImagePreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="modal-footer">-->
<!--                    <button type="submit" class="btn btn-success">Create Location</button>-->
<!--                </div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Edit Location Modal &ndash;&gt;-->
<!--<div class="modal fade" id="editLocationModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="editLocationForm" enctype="multipart/form-data">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Edit Location</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <input type="hidden" id="editLocationId">-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Name</label>-->
<!--                        <input type="text" class="form-control" id="editLocationName" name="editLocationName" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Description</label>-->
<!--                        <input type="text" class="form-control" id="editLocationDescription" name="editLocationDescription" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Address</label>-->
<!--                        <input type="text" class="form-control" id="editLocationAddress" name="editLocationAddress" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Open Hours</label>-->
<!--                        <input type="text" class="form-control" id="editLocationOpenHours" name="editLocationOpenHours" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Image</label>-->
<!--                        <input type="file" class="form-control" id="editLocationImage" name="editLocationImage" accept="image/*">-->
<!--                        <img id="editLocationImagePreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="modal-footer">-->
<!--                    <button type="submit" class="btn btn-success">Update Location</button>-->
<!--                </div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Add Membership Modal &ndash;&gt;-->
<!--<div class="modal fade" id="addMembershipModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="addMembershipForm" enctype="multipart/form-data">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Add Membership Plan</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <div class="mb-3"><label class="form-label">Name</label><input type="text" class="form-control" id="membershipName" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Description</label><input type="text" class="form-control" id="membershipDescription" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Price (LKR)</label><input type="number" step="0.01" class="form-control" id="membershipPrice" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Open Hours</label><input type="text" class="form-control" id="membershipOpenHours" required></div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Classes</label>-->
<!--                        <select id="membershipClassIds" class="form-control" multiple required></select>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Image</label>-->
<!--                        <input type="file" class="form-control" id="membershipImage" accept="image/*">-->
<!--                        <img id="membershipImagePreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="modal-footer"><button type="submit" class="btn btn-success">Create Plan</button></div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Edit Membership Modal &ndash;&gt;-->
<!--<div class="modal fade" id="editMembershipModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="editMembershipForm" enctype="multipart/form-data">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Edit Membership Plan</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <input type="hidden" id="editMembershipId">-->
<!--                    <div class="mb-3"><label class="form-label">Name</label><input type="text" class="form-control" id="editMembershipName" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Description</label><input type="text" class="form-control" id="editMembershipDescription" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Price (LKR)</label><input type="number" step="0.01" class="form-control" id="editMembershipPrice" required></div>-->
<!--                    <div class="mb-3"><label class="form-label">Open Hours</label><input type="text" class="form-control" id="editMembershipOpenHours" required></div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Classes</label>-->
<!--                        <select id="editMembershipClassIds" class="form-control" multiple required></select>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Image</label>-->
<!--                        <input type="file" class="form-control" id="editMembershipImage" accept="image/*">-->
<!--                        <img id="editMembershipImagePreview" class="mt-2" style="width: 80px; height: 80px; display: none; border-radius: 8px;">-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="modal-footer"><button type="submit" class="btn btn-success">Update Plan</button></div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Add Booking Modal &ndash;&gt;-->
<!--<div class="modal fade" id="addBookingModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="addBookingForm">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Add Booking</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">User Email</label>-->
<!--                        <input type="email" class="form-control" id="bookingUserEmail" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Package</label>-->
<!--                        <select id="bookingPackage" class="form-control" required></select>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Class</label>-->
<!--                        <select id="bookingClass" class="form-control" required></select>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Coach</label>-->
<!--                        <select id="bookingCoach" class="form-control" required></select>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Location</label>-->
<!--                        <select id="bookingLocation" class="form-control" required></select>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Booking Date</label>-->
<!--                        <input type="date" class="form-control" id="bookingDate" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">End Date</label>-->
<!--                        <input type="date" class="form-control" id="bookingEndDate" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Number of Sessions</label>-->
<!--                        <input type="number" class="form-control" id="bookingSessions" required min="1">-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Package Price</label>-->
<!--                        <input type="number" step="0.01" class="form-control" id="bookingPackagePrice" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Coach Fee</label>-->
<!--                        <input type="number" step="0.01" class="form-control" id="bookingCoachFee" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Total Price</label>-->
<!--                        <input type="number" step="0.01" class="form-control" id="bookingTotalPrice" readonly>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Status</label>-->
<!--                        <select id="bookingStatus" class="form-control" required>-->
<!--                            <option value="ACTIVE">Active</option>-->
<!--                            <option value="COMPLETED">Completed</option>-->
<!--                            <option value="CANCELLED">Cancelled</option>-->
<!--                        </select>-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="modal-footer">-->
<!--                    <button type="submit" class="btn btn-success">Create Booking</button>-->
<!--                </div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->


<!--&lt;!&ndash; Add Attendance Modal &ndash;&gt;-->
<!--<div class="modal fade" id="addAttendanceModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <form id="addAttendanceForm">-->
<!--                <div class="modal-header">-->
<!--                    <h5 class="modal-title">Mark Attendance</h5>-->
<!--                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--                </div>-->
<!--                <div class="modal-body">-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Member Email</label>-->
<!--                        <input type="email" class="form-control" id="attendanceEmail" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Date</label>-->
<!--                        <input type="date" class="form-control" id="attendanceMarkDate" required value="<?php echo date('Y-m-d'); ?>">-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Type</label>-->
<!--                        <select id="attendanceType" class="form-control" required>-->
<!--                            <option value="checkin">Check-In</option>-->
<!--                            <option value="checkout">Check-Out</option>-->
<!--                        </select>-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="modal-footer">-->
<!--                    <button type="submit" class="btn btn-success">Mark Attendance</button>-->
<!--                </div>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Scripts &ndash;&gt;-->
<!--<script>-->
<!--    document.addEventListener("DOMContentLoaded", function () {-->
<!--        // Membership Growth (Line Chart)-->
<!--        const ctx1 = document.getElementById('membershipChart');-->
<!--        new Chart(ctx1, {-->
<!--            type: 'line',-->
<!--            data: {-->
<!--                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],-->
<!--                datasets: [{-->
<!--                    label: 'New Members',-->
<!--                    data: [30, 45, 60, 80, 95, 120],-->
<!--                    borderColor: '#ff6a00',-->
<!--                    backgroundColor: 'rgba(255, 106, 0, 0.2)',-->
<!--                    tension: 0.4,-->
<!--                    fill: true-->
<!--                }]-->
<!--            },-->
<!--            options: {-->
<!--                responsive: true,-->
<!--                plugins: { legend: { display: false } }-->
<!--            }-->
<!--        });-->

<!--        // Revenue Breakdown (Doughnut Chart)-->
<!--        const ctx2 = document.getElementById('revenueChart');-->
<!--        new Chart(ctx2, {-->
<!--            type: 'doughnut',-->
<!--            data: {-->
<!--                labels: ['Memberships', 'Classes', 'Personal Training'],-->
<!--                datasets: [{-->
<!--                    data: [65, 25, 10],-->
<!--                    backgroundColor: ['#ff6a00', '#007bff', '#28a745'],-->
<!--                    borderWidth: 0-->
<!--                }]-->
<!--            },-->
<!--            options: {-->
<!--                responsive: true,-->
<!--                plugins: {-->
<!--                    legend: {-->
<!--                        position: 'bottom',-->
<!--                        labels: { font: { size: 12 } }-->
<!--                    }-->
<!--                }-->
<!--            }-->
<!--        });-->
<!--    });-->


<!--    // Chart.js defaults (nicer grid + fonts)-->
<!--    Chart.defaults.font.family = "Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";-->
<!--    Chart.defaults.color = "#6b7280";-->

<!--    // Optional: add auth header if you store token in localStorage-->
<!--    function authHeaders() {-->
<!--        const token = localStorage.getItem("token");-->
<!--        return token ? { "Authorization": "Bearer " + token } : {};-->
<!--    }-->

<!--    // Sidebar routing-->
<!--    function showPanel(panelId) {-->
<!--        $('.sidebar a').removeClass('active');-->
<!--        $('.sidebar a').filter(function(){ return $(this).attr('onclick')?.includes(panelId); }).addClass('active');-->

<!--        $('.content > div').addClass('hidden');-->
<!--        $('#' + panelId).removeClass('hidden');-->

<!--        switch (panelId) {-->
<!--            case 'dashboard': loadDashboardCounts(); loadSignupsChart(); loadRevenueChart(); break;-->
<!--            case 'members': loadAllUsers(); break;-->
<!--            case 'guides': loadAllGuides(); break;-->
<!--            case 'classes': loadGuideOptions(); loadAllClasses(); break;-->
<!--            case 'memberships': loadAllClassesForPackages(); loadAllPackages(); break;-->
<!--            case 'bookings': loadAllBookings(); loadBookingOptions(); break;-->
<!--            case 'payments': loadAllPayments(); break;-->
<!--            case 'reviews': loadAllReviews(); break;-->
<!--            case 'attendance': loadAttendance(); break;-->
<!--        }-->
<!--    }-->

<!--    // Logout-->
<!--    function logout() {-->
<!--        localStorage.removeItem("name");-->
<!--        localStorage.removeItem("token");-->
<!--        localStorage.removeItem("email");-->
<!--        localStorage.removeItem("role");-->
<!--        window.location.href = "index.html";-->
<!--    }-->

<!--    // On Ready-->
<!--    $(document).ready(function(){-->
<!--        const adminStoredName = localStorage.getItem("name");-->
<!--        if (adminStoredName) $("#adminName").text(adminStoredName);-->

<!--        showPanel('dashboard');-->

<!--        // Image previews-->
<!--        $("#guideImage").on("change", function(){-->
<!--            const file = this.files[0];-->
<!--            if (!file) return;-->
<!--            $("#guideImagePreview").attr("src", URL.createObjectURL(file)).show();-->
<!--        });-->
<!--        $("#editGuideImage").on("change", function(){-->
<!--            const file = this.files[0];-->
<!--            if (!file) return;-->
<!--            $("#editGuideImgPreview").attr("src", URL.createObjectURL(file)).show();-->
<!--        });-->
<!--        $("#membershipImage").on("change", function(){-->
<!--            const file = this.files[0];-->
<!--            if (!file) return;-->
<!--            $("#membershipImagePreview").attr("src", URL.createObjectURL(file)).show();-->
<!--        });-->
<!--        $("#editMembershipImage").on("change", function(){-->
<!--            const file = this.files[0];-->
<!--            if (!file) return;-->
<!--            $("#editMembershipImagePreview").attr("src", URL.createObjectURL(file)).show();-->
<!--        });-->

<!--        // Live searches-->
<!--        $("#searchMember").on("input", function(){-->
<!--            const q = $(this).val().toLowerCase();-->
<!--            const filtered = (window.allUsers || []).filter(m => (m.name||"").toLowerCase().includes(q) || (m.email||"").toLowerCase().includes(q));-->
<!--            renderUsers(filtered);-->
<!--        });-->
<!--        $("#searchGuide").on("input", function(){-->
<!--            const q = $(this).val().toLowerCase();-->
<!--            const filtered = (window.allGuides || []).filter(g => (g.fullName||"").toLowerCase().includes(q) || (g.email||"").toLowerCase().includes(q));-->
<!--            renderGuides(filtered);-->
<!--        });-->
<!--        $("#searchClass").on("input", function(){-->
<!--            const q = $(this).val().toLowerCase();-->
<!--            const filtered = (window.allClasses || []).filter(c => (c.name||"").toLowerCase().includes(q) || (c.guideName||"").toLowerCase().includes(q));-->
<!--            renderClasses(filtered);-->
<!--        });-->
<!--        $("#searchBooking").on("input", function(){-->
<!--            const q = $(this).val().toLowerCase();-->
<!--            const filtered = (window.allBookings || []).filter(b => (b.userEmail||"").toLowerCase().includes(q));-->
<!--            renderBookings(filtered);-->
<!--        });-->
<!--        $("#searchPaymentEmail").on("input", function () {-->
<!--            const q = $(this).val().toLowerCase();-->
<!--            const filtered = (window.allPayments || []).filter(p => (p.userEmail || "").toLowerCase().includes(q));-->
<!--            renderPayments(filtered);-->
<!--        });-->

<!--        // Forms submit-->
<!--        $("#addMemberForm").on("submit", createUser);-->
<!--        $("#addGuideForm").on("submit", createGuide);-->
<!--        $("#editGuideForm").on("submit", updateGuide);-->
<!--        $("#addClassForm").on("submit", createClass);-->
<!--        $("#editClassForm").on("submit", updateClass);-->
<!--        $("#addMembershipForm").on("submit", createPackage);-->
<!--        $("#editMembershipForm").on("submit", updatePackage);-->
<!--        $("#addBookingForm").on("submit", createBooking);-->
<!--        $("#addAttendanceForm").on("submit", markAttendance);-->

<!--        // Calculate total price for booking-->
<!--        $("#bookingPackagePrice, #bookingCoachFee").on("input", function() {-->
<!--            const packagePrice = parseFloat($("#bookingPackagePrice").val()) || 0;-->
<!--            const coachFee = parseFloat($("#bookingCoachFee").val()) || 0;-->
<!--            $("#bookingTotalPrice").val((packagePrice + coachFee).toFixed(2));-->
<!--        });-->
<!--    });-->

<!--    // DASHBOARD-->
<!--    // DASHBOARD COUNTS-->
<!--    function loadDashboardCounts() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/dashboard/counts",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function (res) {-->
<!--                $("#totalMembers").text(res.data?.totalMembers || 0);-->
<!--                $("#activeMemberships").text(res.data?.activeMemberships || 0);-->
<!--                $("#totalGuides").text(res.data?.totalGuides || 0);-->
<!--                $("#perDayBookings").text(res.data?.perDayBookings || 0);-->
<!--                $("#totalClasses").text(res.data?.totalClasses || 0);-->
<!--                $("#totalLocations").text(res.data?.totalLocations || 0);-->
<!--            },-->
<!--            error: function () {-->
<!--                console.warn("Failed to load dashboard counts.");-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // Instead of charts, add Booking Summary Table-->
<!--    function loadBookingSummary() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/bookings/summary/today",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function (res) {-->
<!--                const tbody = $("#bookingSummaryTable tbody");-->
<!--                tbody.empty();-->
<!--                (res.data || []).forEach(b => {-->
<!--                    tbody.append(`-->
<!--                    <tr>-->
<!--                        <td>${b.memberName}</td>-->
<!--                        <td>${b.className}</td>-->
<!--                        <td>${b.time}</td>-->
<!--                        <td>${b.status}</td>-->
<!--                    </tr>-->
<!--                `);-->
<!--                });-->
<!--            },-->
<!--            error: function () {-->
<!--                console.warn("Failed to load booking summary.");-->
<!--            }-->
<!--        });-->
<!--    }-->


<!--    // MEMBERS (Users)-->
<!--    function loadAllUsers() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/user/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function (res) {-->
<!--                window.allUsers = res.data || [];-->
<!--                renderUsers(window.allUsers);-->
<!--            },-->
<!--            error: function () { alert("Failed to load users."); }-->
<!--        });-->
<!--    }-->

<!--    function renderUsers(users) {-->
<!--        const tbody = $("#memberTableBody");-->
<!--        tbody.empty();-->
<!--        users.forEach(u => {-->
<!--            tbody.append(`-->
<!--        <tr>-->
<!--          <td>${u.name || "-"}</td>-->
<!--          <td>${u.email || "-"}</td>-->
<!--          <td>${u.contact || "-"}</td>-->
<!--          <td><span class="badge bg-${u.role === 'USER' ? 'success' : 'secondary'}">${u.role || "-"}</span></td>-->
<!--          <td>-->
<!--            <button class="btn btn-sm btn-danger" onclick="deleteUser('${u.email}')">Delete</button>-->
<!--          </td>-->
<!--        </tr>-->
<!--      `);-->
<!--        });-->
<!--    }-->

<!--    function createUser(e) {-->
<!--        e.preventDefault();-->
<!--        const payload = {-->
<!--            name: $("#memberName").val(),-->
<!--            email: $("#memberEmail").val(),-->
<!--            contact: $("#memberPhone").val(),-->
<!--            password: $("#memberPassword").val(),-->
<!--            role: "USER"-->
<!--        };-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/user/register",-->
<!--            method: "POST",-->
<!--            headers: { "Content-Type": "application/json", ...authHeaders() },-->
<!--            data: JSON.stringify(payload),-->
<!--            success: function (res) {-->
<!--                if (res.code === 201) {-->
<!--                    $("#addMemberModal").modal("hide");-->
<!--                    $("#addMemberForm")[0].reset();-->
<!--                    loadAllUsers();-->
<!--                    alert("User created successfully!");-->
<!--                } else if (res.code === 406) {-->
<!--                    alert("Email already used. Please use a different email.");-->
<!--                } else {-->
<!--                    alert("Failed to create user: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function (xhr) {-->
<!--                alert("Failed to create user: " + (xhr.responseJSON?.message || "Server error"));-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    function deleteUser(email) {-->
<!--        if (!confirm("Delete this user?")) return;-->
<!--        $.ajax({-->
<!--            url: `http://localhost:8080/api/v1/user/delete/${email}`,-->
<!--            method: "DELETE",-->
<!--            headers: authHeaders(),-->
<!--            success: function () { loadAllUsers(); },-->
<!--            error: function () { alert("Failed to delete user."); }-->
<!--        });-->
<!--    }-->

<!--    // GUIDES-->
<!--    function loadAllGuides() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/guide/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function (res) {-->
<!--                window.allGuides = res.data || [];-->
<!--                renderGuides(window.allGuides);-->
<!--            },-->
<!--            error: function(){ alert("Failed to load guides."); }-->
<!--        });-->
<!--    }-->

<!--    function renderGuides(guides) {-->
<!--        const tbody = $("#guideTableBody");-->
<!--        tbody.empty();-->
<!--        guides.forEach(g => {-->
<!--            const img = g.imageUrl ? `<img src="/Uploads/${g.imageUrl}" style="width:60px;height:60px;border-radius:10px;object-fit:cover; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">` : "-";-->
<!--            tbody.append(`-->
<!--        <tr>-->
<!--          <td>${g.fullName || "-"}</td>-->
<!--          <td>${g.email || "-"}</td>-->
<!--          <td>${img}</td>-->
<!--          <td>${g.description || "-"}</td>-->
<!--          <td>LKR ${Number(g.paymentPerHour || 0).toFixed(2)}</td>-->
<!--          <td>${g.phone || "-"}</td>-->
<!--          <td><span class="badge bg-${g.status === 'ACTIVE' ? 'success' : 'secondary'}">${g.status || "-"}</span></td>-->
<!--          <td><span class="badge bg-${g.booked === 'NO' ? 'success' : 'warning'}">${g.booked || "-"}</span></td>-->
<!--          <td>-->
<!--            <button class="btn btn-sm btn-outline-secondary me-1" onclick='openEditGuide(${JSON.stringify(g).replace(/'/g,"&#39;")})'>Edit</button>-->
<!--            <button class="btn btn-sm btn-danger" onclick="deleteGuide('${g.email}')">Delete</button>-->
<!--          </td>-->
<!--        </tr>-->
<!--      `);-->
<!--        });-->
<!--    }-->

<!--    function openEditGuide(guide) {-->
<!--        $("#editGuideEmail").val(guide.email);-->
<!--        $("#editGuideName").val(guide.fullName || "");-->
<!--        $("#editGuideEmailDisplay").val(guide.email || "");-->
<!--        $("#editGuidePhone").val(guide.phone || "");-->
<!--        $("#editGuideDescription").val(guide.description || "");-->
<!--        $("#editGuidePaymentPerHour").val(guide.paymentPerHour || "");-->
<!--        $("#toggleStatusBtn").text(guide.status === "ACTIVE" ? "Deactivate" : "Activate");-->
<!--        if (guide.imageUrl) {-->
<!--            $("#editGuideImgPreview").attr("src", `/Uploads/${g.imageUrl}`).show();-->
<!--        } else {-->
<!--            $("#editGuideImgPreview").hide();-->
<!--        }-->
<!--        const modal = new bootstrap.Modal(document.getElementById('editGuideModal'));-->
<!--        modal.show();-->
<!--    }-->

<!--    function createGuide(e) {-->
<!--        e.preventDefault();-->
<!--        const fd = new FormData();-->
<!--        fd.append("fullName", $("#guideName").val());-->
<!--        fd.append("email", $("#guideEmail").val());-->
<!--        fd.append("phone", $("#guidePhone").val());-->
<!--        fd.append("description", $("#guideDescription").val());-->
<!--        fd.append("paymentPerHour", $("#guidePaymentPerHour").val());-->
<!--        if ($("#guideImage")[0].files[0]) fd.append("imageUrl", $("#guideImage")[0].files[0]);-->

<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/guide/save",-->
<!--            method: "POST",-->
<!--            headers: authHeaders(),-->
<!--            processData: false,-->
<!--            contentType: false,-->
<!--            data: fd,-->
<!--            success: function(res) {-->
<!--                if (res.status === "Created") {-->
<!--                    $("#addGuideModal").modal("hide");-->
<!--                    $("#addGuideForm")[0].reset();-->
<!--                    $("#guideImagePreview").hide();-->
<!--                    loadAllGuides();-->
<!--                    alert("Guide saved successfully!");-->
<!--                } else {-->
<!--                    alert("Failed to save guide: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                alert("Failed to create guide: " + (xhr.responseJSON?.message || "Server error"));-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    function updateGuide(e) {-->
<!--        e.preventDefault();-->
<!--        const email = $("#editGuideEmail").val();-->
<!--        const fd = new FormData();-->
<!--        fd.append("editGuideName", $("#editGuideName").val());-->
<!--        fd.append("editGuidePhone", $("#editGuidePhone").val());-->
<!--        fd.append("editGuideDescription", $("#editGuideDescription").val());-->
<!--        fd.append("editGuidePayment", $("#editGuidePaymentPerHour").val());-->
<!--        if ($("#editGuideImage")[0].files[0]) fd.append("editGuideImage", $("#editGuideImage")[0].files[0]);-->

<!--        $.ajax({-->
<!--            url: `http://localhost:8080/api/v1/guide/update/${email}`,-->
<!--            method: "POST",-->
<!--            headers: authHeaders(),-->
<!--            processData: false,-->
<!--            contentType: false,-->
<!--            data: fd,-->
<!--            success: function() {-->
<!--                $("#editGuideModal").modal("hide");-->
<!--                loadAllGuides();-->
<!--            },-->
<!--            error: function() { alert("Failed to update guide."); }-->
<!--        });-->
<!--    }-->

<!--    function toggleGuideStatus() {-->
<!--        const email = $("#editGuideEmail").val();-->
<!--        const currentStatus = $("#toggleStatusBtn").text() === "Deactivate" ? "ACTIVE" : "INACTIVE";-->
<!--        const endpoint = currentStatus === "ACTIVE" ? "deactivate" : "activate";-->
<!--        $.ajax({-->
<!--            url: `http://localhost:8080/api/v1/guide/${endpoint}/${email}`,-->
<!--            method: "PUT",-->
<!--            headers: authHeaders(),-->
<!--            success: function() {-->
<!--                $("#editGuideModal").modal("hide");-->
<!--                loadAllGuides();-->
<!--            },-->
<!--            error: function() { alert(`Failed to ${endpoint} guide.`); }-->
<!--        });-->
<!--    }-->

<!--    function deleteGuide(email) {-->
<!--        if (!confirm("Delete this guide?")) return;-->
<!--        $.ajax({-->
<!--            url: `http://localhost:8080/api/v1/guide/delete/${email}`,-->
<!--            method: "DELETE",-->
<!--            headers: authHeaders(),-->
<!--            success: function() { loadAllGuides(); },-->
<!--            error: function() { alert("Failed to delete guide."); }-->
<!--        });-->
<!--    }-->

<!--    // CLASSES-->
<!--    function loadGuideOptions() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/guide/available",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function (res) {-->
<!--                const guides = res.data || [];-->
<!--                const sel = $("#classGuide");-->
<!--                sel.empty();-->
<!--                guides.forEach(g => sel.append(`<option value="${g.id}">${g.fullName}</option>`));-->
<!--                const editSel = $("#editClassGuide");-->
<!--                editSel.empty();-->
<!--                guides.forEach(g => editSel.append(`<option value="${g.id}">${g.fullName}</option>`));-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    function loadAllClasses() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/class/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                window.allClasses = res.data || [];-->
<!--                console.log("Loaded classes:", window.allClasses);-->
<!--                renderClasses(window.allClasses);-->
<!--            },-->
<!--            error: function() { alert("Failed to load classes."); }-->
<!--        });-->
<!--    }-->

<!--    function loadAllClassesForPackages() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/class/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                window.allClassesForPackages = res.data || [];-->
<!--                const sel = $("#membershipClassIds");-->
<!--                const editSel = $("#editMembershipClassIds");-->
<!--                sel.empty();-->
<!--                editSel.empty();-->
<!--                window.allClassesForPackages.forEach(c => {-->
<!--                    sel.append(`<option value="${c.name}">${c.name}</option>`);-->
<!--                    editSel.append(`<option value="${c.name}">${c.name}</option>`);-->
<!--                });-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    function renderClasses(classes) {-->
<!--        const tbody = $("#classTableBody");-->
<!--        tbody.empty();-->
<!--        classes.forEach(c => {-->
<!--            tbody.append(`-->
<!--        <tr>-->
<!--          <td>${c.name || "-"}</td>-->
<!--          <td>${c.trainer || "-"}</td>-->
<!--          <td>${c.day || "-"}</td>-->
<!--          <td>${c.time || "-"}</td>-->
<!--          <td>${c.capacity || 0}</td>-->
<!--          <td>${c.enrolled || 0}</td>-->
<!--          <td><span class="badge bg-${c.status === 'AVAILABLE' ? 'success' : 'secondary'}">${c.status || "-"}</span></td>-->
<!--          <td>-->
<!--            <button class="btn btn-sm btn-outline-secondary me-1" onclick='openEditClass(${JSON.stringify(c).replace(/'/g,"&#39;")})'>Update</button>-->
<!--            <button class="btn btn-sm btn-danger" onclick="deleteClass('${c.id}')">Delete</button>-->
<!--          </td>-->
<!--        </tr>-->
<!--      `);-->
<!--        });-->
<!--    }-->

<!--    function openEditClass(classData) {-->
<!--        $("#editClassId").val(classData.id);-->
<!--        $("#editClassName").val(classData.name || "");-->
<!--        $("#editClassGuide").val(classData.guideId || "");-->
<!--        $("#editClassDay").val(classData.day || "");-->
<!--        const [start, end] = (classData.time || "").split(" - ");-->
<!--        $("#editClassStart").val(start || "");-->
<!--        $("#editClassEnd").val(end || "");-->
<!--        $("#editClassCapacity").val(classData.capacity || "");-->
<!--        const modal = new bootstrap.Modal(document.getElementById('editClassModal'));-->
<!--        modal.show();-->
<!--    }-->

<!--    function createClass(e) {-->
<!--        e.preventDefault();-->
<!--        const startTime = $("#classStart").val();-->
<!--        const endTime = $("#classEnd").val();-->
<!--        const time = `${startTime} - ${endTime}`;-->
<!--        const guideName = $("#classGuide option:selected").text();-->

<!--        const formData = new FormData();-->
<!--        formData.append("name", $("#className").val());-->
<!--        formData.append("trainer", guideName);-->
<!--        formData.append("day", $("#classDay").val());-->
<!--        formData.append("time", time);-->
<!--        formData.append("capacity", parseInt($("#classCapacity").val()));-->

<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/class/save",-->
<!--            method: "POST",-->
<!--            headers: authHeaders(),-->
<!--            processData: false,-->
<!--            contentType: false,-->
<!--            data: formData,-->
<!--            success: function(res) {-->
<!--                if (res.code === 201) {-->
<!--                    $("#addClassModal").modal("hide");-->
<!--                    $("#addClassForm")[0].reset();-->
<!--                    loadAllClasses();-->
<!--                    alert("Class created successfully!");-->
<!--                } else {-->
<!--                    alert("Failed to create class: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                console.error("API Error:", xhr.responseText);-->
<!--                alert("Failed to create class: " + (xhr.responseJSON?.message || "Server error. Check console for details."));-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    function updateClass(e) {-->
<!--        e.preventDefault();-->
<!--        const id = $("#editClassId").val();-->
<!--        const startTime = $("#editClassStart").val();-->
<!--        const endTime = $("#editClassEnd").val();-->
<!--        const time = `${startTime} - ${endTime}`;-->
<!--        const guideName = $("#editClassGuide option:selected").text();-->

<!--        const formData = new FormData();-->
<!--        formData.append("editName", $("#editClassName").val());-->
<!--        formData.append("editTrainer", guideName);-->
<!--        formData.append("editDay", $("#editClassDay").val());-->
<!--        formData.append("editTime", time);-->
<!--        formData.append("editCapacity", parseInt($("#editClassCapacity").val()));-->

<!--        $.ajax({-->
<!--            url: `http://localhost:8080/api/v1/class/update/${id}`,-->
<!--            method: "PUT",-->
<!--            headers: authHeaders(),-->
<!--            processData: false,-->
<!--            contentType: false,-->
<!--            data: formData,-->
<!--            success: function(res) {-->
<!--                if (res.code === 201) {-->
<!--                    $("#editClassModal").modal("hide");-->
<!--                    loadAllClasses();-->
<!--                    alert("Class updated successfully!");-->
<!--                } else {-->
<!--                    alert("Failed to update class: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                console.error("API Error:", xhr.responseText);-->
<!--                alert("Failed to update class: " + (xhr.responseJSON?.message || "Server error. Check console for details."));-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    function deleteClass(id) {-->
<!--        if (!confirm("Delete this class?")) return;-->
<!--        $.ajax({-->
<!--            url: `http://localhost:8080/api/v1/class/delete/${id}`,-->
<!--            method: "DELETE",-->
<!--            headers: authHeaders(),-->
<!--            success: function() { loadAllClasses(); },-->
<!--            error: function() { alert("Failed to delete class."); }-->
<!--        });-->
<!--    }-->

<!--    // Image preview for add location-->
<!--    $("#locationImage").on("change", function() {-->
<!--        const file = this.files[0];-->
<!--        if (file) {-->
<!--            $("#locationImagePreview").attr("src", URL.createObjectURL(file)).show();-->
<!--        } else {-->
<!--            $("#locationImagePreview").hide();-->
<!--        }-->
<!--    });-->

<!--    // Image preview for edit location-->
<!--    $("#editLocationImage").on("change", function() {-->
<!--        const file = this.files[0];-->
<!--        if (file) {-->
<!--            $("#editLocationImagePreview").attr("src", URL.createObjectURL(file)).show();-->
<!--        } else {-->
<!--            $("#editLocationImagePreview").hide();-->
<!--        }-->
<!--    });-->

<!--    // Live search for locations-->
<!--    $("#searchLocation").on("input", function() {-->
<!--        const q = $(this).val().toLowerCase();-->
<!--        const filtered = (window.allLocations || []).filter(l =>-->
<!--            (l.name || "").toLowerCase().includes(q) ||-->
<!--            (l.address || "").toLowerCase().includes(q)-->
<!--        );-->
<!--        renderLocations(filtered);-->
<!--    });-->

<!--    function loadAllLocations() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/location/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                console.log("Load locations response:", res);-->
<!--                if (res.code === 200) {-->
<!--                    window.allLocations = res.data || [];-->
<!--                    renderLocations(window.allLocations);-->
<!--                } else {-->
<!--                    alert("Failed to load locations: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                console.error("Load locations error:", xhr.status, xhr.responseText);-->
<!--                alert("Failed to load locations: " + (xhr.responseJSON?.message || "Server error"));-->
<!--            }-->
<!--        });-->
<!--    }-->


<!--    // Render locations table-->
<!--    function renderLocations(locations) {-->
<!--        const tbody = $("#locationTableBody");-->
<!--        tbody.empty();-->
<!--        locations.forEach(l => {-->
<!--            const img = l.imageUrl-->
<!--                ? `<img src="http://localhost:8080/uploads/${l.imageUrl}" style="width:60px;height:60px;border-radius:10px;object-fit:cover; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" onerror="this.src='/fallback-image.jpg';">`-->
<!--                : "-";-->
<!--            tbody.append(`-->
<!--            <tr>-->
<!--                <td>${l.name || "-"}</td>-->
<!--                <td>${l.description || "-"}</td>-->
<!--                <td>${l.address || "-"}</td>-->
<!--                <td>${l.openHours || "-"}</td>-->
<!--                <td>${img}</td>-->
<!--                <td>-->
<!--                    <button class="btn btn-sm btn-outline-secondary me-1" onclick='openEditLocation(${JSON.stringify(l).replace(/'/g,"&#39;")})'>Edit</button>-->
<!--                    <button class="btn btn-sm btn-danger" onclick="deleteLocation(${l.id})">Delete</button>-->
<!--                </td>-->
<!--            </tr>-->
<!--        `);-->
<!--        });-->
<!--    }-->

<!--    // Open edit location modal-->
<!--    function openEditLocation(location) {-->
<!--        $("#editLocationId").val(location.id || "");-->
<!--        $("#editLocationName").val(location.name || "");-->
<!--        $("#editLocationDescription").val(location.description || "");-->
<!--        $("#editLocationAddress").val(location.address || "");-->
<!--        $("#editLocationOpenHours").val(location.openHours || "");-->
<!--        if (location.imageUrl) {-->
<!--            $("#editLocationImagePreview").attr("src", `http://localhost:8080/uploads/${location.imageUrl}`).show();-->
<!--        } else {-->
<!--            $("#editLocationImagePreview").hide();-->
<!--        }-->
<!--        const modal = new bootstrap.Modal(document.getElementById('editLocationModal'));-->
<!--        modal.show();-->
<!--    }-->

<!--    // Create location-->
<!--    function createLocation(e) {-->
<!--        e.preventDefault();-->
<!--        const fd = new FormData();-->
<!--        fd.append("name", $("#locationName").val());-->
<!--        fd.append("description", $("#locationDescription").val());-->
<!--        fd.append("address", $("#locationAddress").val());-->
<!--        fd.append("openHours", $("#locationOpenHours").val());-->
<!--        if ($("#locationImage")[0].files[0]) {-->
<!--            fd.append("imageUrl", $("#locationImage")[0].files[0]);-->
<!--        }-->
<!--        for (let pair of fd.entries()) {-->
<!--            console.log("FormData:", pair[0] + ': ' + pair[1]);-->
<!--        }-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/location/save",-->
<!--            method: "POST",-->
<!--            headers: authHeaders(),-->
<!--            processData: false,-->
<!--            contentType: false,-->
<!--            data: fd,-->
<!--            success: function(res) {-->
<!--                console.log("Create location response:", res);-->
<!--                if (res.code === 201) {-->
<!--                    $("#addLocationModal").modal("hide");-->
<!--                    $("#addLocationForm")[0].reset();-->
<!--                    $("#locationImagePreview").hide();-->
<!--                    loadAllLocations();-->
<!--                    alert("Location created successfully!");-->
<!--                } else if (res.code === 406) {-->
<!--                    alert("Location already exists. Please use a different name.");-->
<!--                } else {-->
<!--                    alert("Failed to create location: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                console.error("Create location error:", xhr.status, xhr.responseText);-->
<!--                alert("Failed to create location: " + (xhr.responseJSON?.message || "Server error"));-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // Update location-->
<!--    function updateLocation(e) {-->
<!--        e.preventDefault();-->
<!--        const id = $("#editLocationId").val();-->
<!--        const fd = new FormData();-->
<!--        fd.append("name", $("#editLocationName").val()); // Match backend param name-->
<!--        fd.append("description", $("#editLocationDescription").val());-->
<!--        fd.append("address", $("#editLocationAddress").val());-->
<!--        fd.append("openHours", $("#editLocationOpenHours").val());-->
<!--        if ($("#editLocationImage")[0].files[0]) {-->
<!--            fd.append("imageUrl", $("#editLocationImage")[0].files[0]); // Match backend param name-->
<!--        }-->
<!--        $.ajax({-->
<!--            url: `http://localhost:8080/api/v1/location/update/${id}`,-->
<!--            method: "POST",-->
<!--            headers: authHeaders(),-->
<!--            processData: false,-->
<!--            contentType: false,-->
<!--            data: fd,-->
<!--            success: function(res) {-->
<!--                console.log("Update location response:", res);-->
<!--                if (res.code === 200) {-->
<!--                    $("#editLocationModal").modal("hide");-->
<!--                    loadAllLocations();-->
<!--                    alert("Location updated successfully!");-->
<!--                } else if (res.code === 404) {-->
<!--                    alert("Location not found.");-->
<!--                } else {-->
<!--                    alert("Failed to update location: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                console.error("Update location error:", xhr.status, xhr.responseText);-->
<!--                alert("Failed to update location: " + (xhr.responseJSON?.message || "Server error"));-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // Delete location-->
<!--    function deleteLocation(id) {-->
<!--        if (!confirm("Are you sure you want to delete this location?")) return;-->
<!--        $.ajax({-->
<!--            url: `http://localhost:8080/api/v1/location/delete/${id}`,-->
<!--            method: "DELETE",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                console.log("Delete location response:", res);-->
<!--                if (res.code === 200) {-->
<!--                    loadAllLocations();-->
<!--                    alert("Location deleted successfully!");-->
<!--                } else if (res.code === 404) {-->
<!--                    alert("Location not found.");-->
<!--                } else {-->
<!--                    alert("Failed to delete location: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                console.error("Delete location error:", xhr.status, xhr.responseText);-->
<!--                alert("Failed to delete location: " + (xhr.responseJSON?.message || "Server error"));-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // Ensure location panel loads data-->
<!--    $(document).ready(function() {-->
<!--        $("#addLocationForm").on("submit", createLocation);-->
<!--        $("#editLocationForm").on("submit", updateLocation);-->

<!--        $('.sidebar a').filter(function(){ return $(this).attr('onclick')?.includes('locations'); }).on('click', function() {-->
<!--            showPanel('locations');-->
<!--            loadAllLocations();-->
<!--        });-->
<!--    });-->


<!--    // MEMBERSHIPS (Packages)-->
<!--    function loadAllPackages() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/package/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function (res) {-->
<!--                window.allPackages = res.data || [];-->
<!--                renderPackages(window.allPackages);-->
<!--            },-->
<!--            error: function() { alert("Failed to load packages."); }-->
<!--        });-->
<!--    }-->

<!--    function renderPackages(packages) {-->
<!--        const tbody = $("#membershipTableBody");-->
<!--        tbody.empty();-->
<!--        packages.forEach(p => {-->
<!--            const classes = p.classes ? p.classes.join(", ") : "-";-->
<!--            const img = p.imageUrl ? `<img src="/Uploads/${p.imageUrl}" style="width:60px;height:60px;border-radius:10px;object-fit:cover; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">` : "-";-->
<!--            tbody.append(`-->
<!--                <tr>-->
<!--                    <td>${p.id || "-"}</td>-->
<!--                    <td>${p.name || "-"}</td>-->
<!--                    <td>${p.description || "-"}</td>-->
<!--                    <td>LKR ${Number(p.price || 0).toFixed(2)}</td>-->
<!--                    <td>${img}</td>-->
<!--                    <td>${p.openHours || "-"}</td>-->
<!--                    <td>${classes}</td>-->
<!--                    <td>-->
<!--                        <button class="btn btn-sm btn-outline-secondary me-1" onclick='openEditPackage(${JSON.stringify(p).replace(/'/g,"&#39;")})'>Edit</button>-->
<!--                        <button class="btn btn-sm btn-danger" onclick="deletePackage(${p.id})">Delete</button>-->
<!--                    </td>-->
<!--                </tr>-->
<!--            `);-->
<!--        });-->
<!--    }-->

<!--    function loadAllClassesForPackages() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/class/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                window.allClassesForPackages = res.data || [];-->
<!--                const sel = $("#membershipClassIds");-->
<!--                const editSel = $("#editMembershipClassIds");-->
<!--                sel.empty();-->
<!--                editSel.empty();-->
<!--                window.allClassesForPackages.forEach(c => {-->
<!--                    sel.append(`<option value="${c.name}">${c.name}</option>`);-->
<!--                    editSel.append(`<option value="${c.name}">${c.name}</option>`);-->
<!--                });-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    function openEditPackage(packageData) {-->
<!--        $("#editMembershipId").val(packageData.id);-->
<!--        $("#editMembershipName").val(packageData.name || "");-->
<!--        $("#editMembershipDescription").val(packageData.description || "");-->
<!--        $("#editMembershipPrice").val(packageData.price || "");-->
<!--        $("#editMembershipOpenHours").val(packageData.openHours || "");-->
<!--        const sel = $("#editMembershipClassIds");-->
<!--        sel.val(packageData.classes || []);-->
<!--        if (packageData.imageUrl) {-->
<!--            $("#editMembershipImagePreview").attr("src", `/Uploads/${packageData.imageUrl}`).show();-->
<!--        } else {-->
<!--            $("#editMembershipImagePreview").hide();-->
<!--        }-->
<!--        const modal = new bootstrap.Modal(document.getElementById('editMembershipModal'));-->
<!--        modal.show();-->
<!--    }-->

<!--    function createPackage(e) {-->
<!--        e.preventDefault();-->
<!--        const fd = new FormData();-->
<!--        fd.append("name", $("#membershipName").val());-->
<!--        fd.append("description", $("#membershipDescription").val());-->
<!--        fd.append("price", $("#membershipPrice").val());-->
<!--        fd.append("openHours", $("#membershipOpenHours").val());-->
<!--        $("#membershipClassIds option:selected").each(function() {-->
<!--            fd.append("classIds", $(this).val());-->
<!--        });-->
<!--        if ($("#membershipImage")[0].files[0]) fd.append("imageUrl", $("#membershipImage")[0].files[0]);-->

<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/package/save",-->
<!--            method: "POST",-->
<!--            headers: authHeaders(),-->
<!--            processData: false,-->
<!--            contentType: false,-->
<!--            data: fd,-->
<!--            success: function(res) {-->
<!--                if (res.code === 201) {-->
<!--                    $("#addMembershipModal").modal("hide");-->
<!--                    $("#addMembershipForm")[0].reset();-->
<!--                    $("#membershipImagePreview").hide();-->
<!--                    loadAllPackages();-->
<!--                    alert("Package created successfully!");-->
<!--                } else if (res.code === 406) {-->
<!--                    alert("Package already exists. Please use a different name.");-->
<!--                } else {-->
<!--                    alert("Failed to create package: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                alert("Failed to create package: " + (xhr.responseJSON?.message || "Server error"));-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    function updatePackage(e) {-->
<!--        e.preventDefault();-->
<!--        const id = $("#editMembershipId").val();-->
<!--        const fd = new FormData();-->
<!--        fd.append("editMembershipName", $("#editMembershipName").val());-->
<!--        fd.append("editMembershipDescription", $("#editMembershipDescription").val());-->
<!--        fd.append("editMembershipPrice", $("#editMembershipPrice").val());-->
<!--        fd.append("editMembershipOpenHours", $("#editMembershipOpenHours").val());-->
<!--        $("#editMembershipClassIds option:selected").each(function() {-->
<!--            fd.append("editMembershipClassIds", $(this).val());-->
<!--        });-->
<!--        if ($("#editMembershipImage")[0].files[0]) fd.append("editMembershipImage", $("#editMembershipImage")[0].files[0]);-->

<!--        $.ajax({-->
<!--            url: `http://localhost:8080/api/v1/package/update/${id}`,-->
<!--            method: "POST",-->
<!--            headers: authHeaders(),-->
<!--            processData: false,-->
<!--            contentType: false,-->
<!--            data: fd,-->
<!--            success: function(res) {-->
<!--                if (res.code === 201) {-->
<!--                    $("#editMembershipModal").modal("hide");-->
<!--                    loadAllPackages();-->
<!--                    alert("Package updated successfully!");-->
<!--                } else {-->
<!--                    alert("Failed to update package: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                alert("Failed to update package: " + (xhr.responseJSON?.message || "Server error"));-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    function deletePackage(id) {-->
<!--        if (!confirm("Delete this package?")) return;-->
<!--        $.ajax({-->
<!--            url: `http://localhost:8080/api/v1/package/delete/${id}`,-->
<!--            method: "DELETE",-->
<!--            headers: authHeaders(),-->
<!--            success: function() { loadAllPackages(); },-->
<!--            error: function() { alert("Failed to delete package."); }-->
<!--        });-->
<!--    }-->

<!--    // BOOKINGS-->
<!--    function loadBookingOptions() {-->
<!--        // Load Packages-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/package/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                const packages = res.data || [];-->
<!--                const sel = $("#bookingPackage");-->
<!--                sel.empty();-->
<!--                packages.forEach(p => sel.append(`<option value="${p.name}">${p.name}</option>`));-->
<!--            },-->
<!--            error: function() { console.warn("Failed to load packages for booking."); }-->
<!--        });-->

<!--        // Load Classes-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/class/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                const classes = res.data || [];-->
<!--                const sel = $("#bookingClass");-->
<!--                sel.empty();-->
<!--                classes.forEach(c => sel.append(`<option value="${c.name}">${c.name}</option>`));-->
<!--            },-->
<!--            error: function() { console.warn("Failed to load classes for booking."); }-->
<!--        });-->

<!--        // Load Coaches-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/guide/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                const coaches = res.data || [];-->
<!--                const sel = $("#bookingCoach");-->
<!--                sel.empty();-->
<!--                coaches.forEach(c => sel.append(`<option value="${c.email}">${c.fullName}</option>`));-->
<!--            },-->
<!--            error: function() { console.warn("Failed to load coaches for booking."); }-->
<!--        });-->

<!--        // Load Locations-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/location/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                const locations = res.data || [];-->
<!--                const sel = $("#bookingLocation");-->
<!--                sel.empty();-->
<!--                locations.forEach(l => sel.append(`<option value="${l.name}">${l.name}</option>`));-->
<!--            },-->
<!--            error: function() { console.warn("Failed to load locations for booking."); }-->
<!--        });-->
<!--    }-->

<!--    function loadAllBookings() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/bookings/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                window.allBookings = res.data || [];-->
<!--                renderBookings(window.allBookings);-->
<!--            },-->
<!--            error: function() { alert("Failed to load bookings."); }-->
<!--        });-->
<!--    }-->

<!--    function renderBookings(bookings) {-->
<!--        const tbody = $("#bookingTableBody");-->
<!--        tbody.empty();-->
<!--        bookings.forEach(b => {-->
<!--            tbody.append(`-->
<!--                <tr>-->
<!--                    <td>${b.userEmail || "-"}</td>-->
<!--                    <td>${b.packageName || "-"}</td>-->
<!--                    <td>${b.className || "-"}</td>-->
<!--                    <td>${b.coachEmail || "-"}</td>-->
<!--                    <td>${b.locationName || "-"}</td>-->
<!--                    <td>${b.bookingDate || "-"}</td>-->
<!--                    <td>${b.endDate || "-"}</td>-->
<!--                    <td>${b.numberOfSessions || 0}</td>-->
<!--                    <td>LKR ${Number(b.packagePrice || 0).toFixed(2)}</td>-->
<!--                    <td>LKR ${Number(b.coachFee || 0).toFixed(2)}</td>-->
<!--                    <td>LKR ${Number(b.totalPrice || 0).toFixed(2)}</td>-->
<!--                    <td><span class="badge bg-${b.status === 'ACTIVE' ? 'success' : b.status === 'COMPLETED' ? 'primary' : 'danger'}">${b.status || "-"}</span></td>-->
<!--                </tr>-->
<!--            `);-->
<!--        });-->
<!--    }-->

<!--    function createBooking(e) {-->
<!--        e.preventDefault();-->

<!--        const formData = {-->
<!--            userEmail: $("#bookingUserEmail").val(),-->
<!--            packageName: $("#bookingPackage").val(),-->
<!--            className: $("#bookingClass").val(),-->
<!--            coachEmail: $("#bookingCoach").val(),-->
<!--            locationName: $("#bookingLocation").val(),-->
<!--            bookingDate: $("#bookingDate").val(),-->
<!--            endDate: $("#bookingEndDate").val(),-->
<!--            numberOfSessions: parseInt($("#bookingSessions").val()),-->
<!--            packagePrice: parseFloat($("#bookingPackagePrice").val()),-->
<!--            coachFee: parseFloat($("#bookingCoachFee").val()),-->
<!--            totalPrice: parseFloat($("#bookingTotalPrice").val()),-->
<!--            status: $("#bookingStatus").val()-->
<!--        };-->

<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/bookings/save",-->
<!--            method: "POST",-->
<!--            headers: { "Content-Type": "application/json", ...authHeaders() },-->
<!--            data: JSON.stringify(formData),-->
<!--            success: function(res) {-->
<!--                if (res.code === 201) {-->
<!--                    $("#addBookingModal").modal("hide");-->
<!--                    $("#addBookingForm")[0].reset();-->
<!--                    loadAllBookings();-->
<!--                    alert("Booking created successfully!");-->
<!--                } else {-->
<!--                    alert("Failed to create booking: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                alert("Failed to create booking: " + (xhr.responseJSON?.message || "Server error"));-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // PAYMENTS-->
<!--    // PAYMENTS (updated)-->
<!--    function loadAllPayments() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/payment/getAll",-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                window.allPayments = res.data || [];-->
<!--                renderPayments(window.allPayments);-->
<!--            },-->
<!--            error: function() { alert("Failed to load payments."); }-->
<!--        });-->
<!--    }-->

<!--    function renderPayments(payments) {-->
<!--        const tbody = $("#paymentTableBody");-->
<!--        tbody.empty();-->
<!--        payments.forEach(p => {-->
<!--            const cardNumberDisplay = p.cardNumber ? "**** **** **** " + (p.cardNumber.slice(-4) || "") : "-";-->
<!--            const cvvDisplay = p.cvv ? "***" : "-";-->
<!--            const paymentDateDisplay = p.paymentDate ? new Date(p.paymentDate).toLocaleString() : "-";-->
<!--            tbody.append(`-->
<!--            <tr>-->
<!--                <td>${p.id || "-"}</td>-->
<!--                <td>${p.userEmail || "-"}</td>-->
<!--                <td>LKR ${Number(p.amount || 0).toFixed(2)}</td>-->
<!--                <td>${p.cardHolderName || "-"}</td>-->
<!--                <td>${cardNumberDisplay}</td>-->
<!--                <td>${p.expiryDate || "-"}</td>-->
<!--                <td>${cvvDisplay}</td>-->
<!--                <td>${paymentDateDisplay}</td>-->
<!--            </tr>-->
<!--        `);-->
<!--        });-->
<!--    }-->


<!--    // Add these to the $(document).ready function-->
<!--    $("#searchReview").on("input", function(){-->
<!--        const q = $(this).val().toLowerCase();-->
<!--        const filtered = (window.allReviews || []).filter(r =>-->
<!--            (r.userEmail || "").toLowerCase().includes(q) ||-->
<!--            (r.rating || "").toString().includes(q) ||-->
<!--            (r.comment || "").toLowerCase().includes(q)-->
<!--        );-->
<!--        renderReviews(filtered);-->
<!--    });-->

<!--    // $("#addReviewForm").on("submit", createReview);-->
<!--    // $("#editReviewForm").on("submit", updateReview);-->

<!--    $(document).ready(function() {-->
<!--        // Search filter-->
<!--        $("#searchReview").on("input", function() {-->
<!--            const q = $(this).val().toLowerCase();-->
<!--            const filtered = (window.allReviews || []).filter(r =>-->
<!--                (r.userEmail || "").toLowerCase().includes(q) ||-->
<!--                (r.rating || "").toString().includes(q) ||-->
<!--                (r.comment || "").toLowerCase().includes(q)-->
<!--            );-->
<!--            renderReviews(filtered);-->
<!--        });-->

<!--        // // Form submissions-->
<!--        // $("#addReviewForm").on("submit", createReview);-->
<!--        // $("#editReviewForm").on("submit", updateReview);-->
<!--    });-->

<!--    // Load all reviews from backend-->
<!--    function loadAllReviews() {-->
<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/user-reviews/getAll",-->
<!--            method: "GET",-->
<!--            success: function(res) {-->
<!--                window.allReviews = res || [];-->
<!--                renderReviews(window.allReviews);-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                console.error(xhr);-->
<!--                alert("Failed to load reviews.");-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    // Render reviews in table-->
<!--    function renderReviews(reviews) {-->
<!--        const tbody = $("#reviewTableBody");-->
<!--        tbody.empty();-->
<!--        reviews.forEach(r => {-->
<!--            const createdAt = r.createdAt ? new Date(r.createdAt).toLocaleString() : "-";-->
<!--            tbody.append(`-->
<!--            <tr>-->
<!--                <td>${r.reviewId || "-"}</td>-->
<!--                <td>${r.userName || "-"}</td>-->
<!--                <td>${r.userEmail || "-"}</td>-->
<!--                <td>${r.rating || "-"}</td>-->
<!--                <td>${r.comment || "-"}</td>-->
<!--                <td>${createdAt}</td>-->
<!--                <td>-->
<!--                    <button class="btn btn-sm btn-danger" onclick="deleteReview(${r.reviewId})">Delete</button>-->
<!--                </td>-->
<!--            </tr>-->
<!--        `);-->
<!--        });-->
<!--    }-->
<!--    // function openEditReview(review) {-->
<!--    //     $("#editReviewId").val(review.reviewId);-->
<!--    //     $("#editReviewUserEmail").val(review.userEmail);-->
<!--    //     $("#editReviewRating").val(review.rating);-->
<!--    //     $("#editReviewComment").val(review.comment);-->
<!--    //     const modal = new bootstrap.Modal(document.getElementById('editReviewModal'));-->
<!--    //     modal.show();-->
<!--    // }-->

<!--    // function createReview(e) {-->
<!--    //     e.preventDefault();-->
<!--    //     const payload = {-->
<!--    //         userEmail: $("#reviewUserEmail").val(),-->
<!--    //         rating: parseInt($("#reviewRating").val()),-->
<!--    //         comment: $("#reviewComment").val()-->
<!--    //     };-->
<!--    //     $.ajax({-->
<!--    //         url: "http://localhost:8080/api/v1/user-reviews/save",-->
<!--    //         method: "POST",-->
<!--    //         headers: { "Content-Type": "application/json", ...authHeaders() },-->
<!--    //         data: JSON.stringify(payload),-->
<!--    //         success: function(res) {-->
<!--    //             if (res.code === 200 || res.code === 201) { // Adjust based on your backend response codes-->
<!--    //                 $("#addReviewModal").modal("hide");-->
<!--    //                 $("#addReviewForm")[0].reset();-->
<!--    //                 loadAllReviews();-->
<!--    //                 alert("Review created successfully!");-->
<!--    //             } else {-->
<!--    //                 alert("Failed to create review: " + (res.message || "Unknown error"));-->
<!--    //             }-->
<!--    //         },-->
<!--    //         error: function(xhr) {-->
<!--    //             alert("Failed to create review: " + (xhr.responseJSON?.message || "Server error"));-->
<!--    //         }-->
<!--    //     });-->
<!--    // }-->

<!--    // function updateReview(e) {-->
<!--    //     e.preventDefault();-->
<!--    //     const payload = {-->
<!--    //         reviewId: parseInt($("#editReviewId").val()),-->
<!--    //         userEmail: $("#editReviewUserEmail").val(),-->
<!--    //         rating: parseInt($("#editReviewRating").val()),-->
<!--    //         comment: $("#editReviewComment").val()-->
<!--    //     };-->
<!--    //     $.ajax({-->
<!--    //         url: "http://localhost:8080/api/v1/user-reviews/update",-->
<!--    //         method: "PUT",-->
<!--    //         headers: { "Content-Type": "application/json", ...authHeaders() },-->
<!--    //         data: JSON.stringify(payload),-->
<!--    //         success: function(res) {-->
<!--    //             if (res.code === 200) {-->
<!--    //                 $("#editReviewModal").modal("hide");-->
<!--    //                 loadAllReviews();-->
<!--    //                 alert("Review updated successfully!");-->
<!--    //             } else {-->
<!--    //                 alert("Failed to update review: " + (res.message || "Unknown error"));-->
<!--    //             }-->
<!--    //         },-->
<!--    //         error: function(xhr) {-->
<!--    //             alert("Failed to update review: " + (xhr.responseJSON?.message || "Server error"));-->
<!--    //         }-->
<!--    //     });-->
<!--    // }-->

<!--    function deleteReview(id) {-->
<!--        if (!confirm("Delete this review?")) return;-->
<!--        $.ajax({-->
<!--            url: `http://localhost:8080/api/v1/user-reviews/delete/${id}`,-->
<!--            method: "DELETE",-->
<!--            headers: authHeaders(),-->
<!--            success: function() { loadAllReviews(); },-->
<!--            error: function() { alert("Failed to delete review."); }-->
<!--        });-->
<!--    }-->

<!--    // ATTENDANCE-->
<!--    function loadAttendance() {-->
<!--        const date = $("#attendanceDate").val();-->
<!--        const search = $("#attendanceSearch").val();-->

<!--        let url = "http://localhost:8080/api/v1/attendance/getAll";-->
<!--        if (date || search) {-->
<!--            url += "?";-->
<!--            if (date) url += `date=${date}&`;-->
<!--            if (search) url += `search=${encodeURIComponent(search)}&`;-->
<!--            url = url.slice(0, -1); // Remove trailing &-->
<!--        }-->

<!--        $.ajax({-->
<!--            url: url,-->
<!--            method: "GET",-->
<!--            headers: authHeaders(),-->
<!--            success: function(res) {-->
<!--                renderAttendance(res.data || []);-->
<!--            },-->
<!--            error: function() { alert("Failed to load attendance records."); }-->
<!--        });-->
<!--    }-->

<!--    function renderAttendance(records) {-->
<!--        const tbody = $("#attendanceTableBody");-->
<!--        tbody.empty();-->
<!--        records.forEach(r => {-->
<!--            tbody.append(`-->
<!--                <tr>-->
<!--                    <td>${r.date || "-"}</td>-->
<!--                    <td>${r.memberName || "-"}</td>-->
<!--                    <td>${r.memberEmail || "-"}</td>-->
<!--                    <td>${r.checkInTime || "-"}</td>-->
<!--                    <td>${r.checkOutTime || "-"}</td>-->
<!--                    <td><span class="badge bg-${r.status === 'PRESENT' ? 'success' : 'secondary'}">${r.status || "-"}</span></td>-->
<!--                </tr>-->
<!--            `);-->
<!--        });-->
<!--    }-->

<!--    function markAttendance(e) {-->
<!--        e.preventDefault();-->

<!--        const formData = {-->
<!--            memberEmail: $("#attendanceEmail").val(),-->
<!--            date: $("#attendanceMarkDate").val(),-->
<!--            type: $("#attendanceType").val() // "checkin" or "checkout"-->
<!--        };-->

<!--        $.ajax({-->
<!--            url: "http://localhost:8080/api/v1/attendance/mark",-->
<!--            method: "POST",-->
<!--            headers: { "Content-Type": "application/json", ...authHeaders() },-->
<!--            data: JSON.stringify(formData),-->
<!--            success: function(res) {-->
<!--                if (res.code === 201) {-->
<!--                    $("#addAttendanceModal").modal("hide");-->
<!--                    $("#addAttendanceForm")[0].reset();-->
<!--                    loadAttendance();-->
<!--                    alert("Attendance marked successfully!");-->
<!--                } else {-->
<!--                    alert("Failed to mark attendance: " + (res.message || "Unknown error"));-->
<!--                }-->
<!--            },-->
<!--            error: function(xhr) {-->
<!--                alert("Failed to mark attendance: " + (xhr.responseJSON?.message || "Server error"));-->
<!--            }-->
<!--        });-->
<!--    }-->
<!--</script>-->

<!--&lt;!&ndash; Bootstrap JS Bundle with Popper &ndash;&gt;-->
<!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>-->
<!--</body>-->
<!--</html>-->




